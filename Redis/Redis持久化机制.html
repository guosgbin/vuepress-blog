<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.62" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://blog.guosgbin.cn/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html"><meta property="og:title" content="RedisæŒä¹…åŒ–æœºåˆ¶"><meta property="og:description" content="ç‰ˆæœ¬ å†…å®¹ æ—¶é—´ ---- ---- ---------------------- V1 æ–°å»º 2023å¹´03æœˆ30æ—¥01:25:08 æœ¬æ–‡å†…å®¹æ¥è‡ªï¼š 1. https://redis.io/docs/management/persistence/ 2. ã€ŠRedis ä½¿ç”¨æ‰‹å†Œã€‹ -- å¯ä»¥ 3. ã€ŠRedis å¼€å‘å’Œè¿ç»´ã€‹-- å¾ˆæ£’ 4. ã€ŠRedi..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-05-07T11:11:01.000Z"><meta property="article:author" content="è¶…å¨è“çŒ« Dylan Kwok"><meta property="article:modified_time" content="2023-05-07T11:11:01.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"RedisæŒä¹…åŒ–æœºåˆ¶","image":[""],"dateModified":"2023-05-07T11:11:01.000Z","author":[{"@type":"Person","name":"è¶…å¨è“çŒ« Dylan Kwok","url":"","email":"guosgbin@163.com"}]}</script><link rel="icon" href="/å°ç†ŠçŒ«.svg"><title>RedisæŒä¹…åŒ–æœºåˆ¶</title><meta name="description" content="ç‰ˆæœ¬ å†…å®¹ æ—¶é—´ ---- ---- ---------------------- V1 æ–°å»º 2023å¹´03æœˆ30æ—¥01:25:08 æœ¬æ–‡å†…å®¹æ¥è‡ªï¼š 1. https://redis.io/docs/management/persistence/ 2. ã€ŠRedis ä½¿ç”¨æ‰‹å†Œã€‹ -- å¯ä»¥ 3. ã€ŠRedis å¼€å‘å’Œè¿ç»´ã€‹-- å¾ˆæ£’ 4. ã€ŠRedi...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-542658da.css" as="style"><link rel="stylesheet" href="/assets/style-542658da.css">
    <link rel="modulepreload" href="/assets/app-ba4ae9cd.js"><link rel="modulepreload" href="/assets/RedisæŒä¹…åŒ–æœºåˆ¶.html-9a805fc8.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-c27b6911.js"><link rel="modulepreload" href="/assets/RedisæŒä¹…åŒ–æœºåˆ¶.html-53af3f7a.js"><link rel="prefetch" href="/assets/index.html-d9edbc0d.js" as="script"><link rel="prefetch" href="/assets/01-åˆ›å»ºå’Œé”€æ¯å¯¹è±¡.html-98280ce1.js" as="script"><link rel="prefetch" href="/assets/index.html-c4f42206.js" as="script"><link rel="prefetch" href="/assets/SPIæœºåˆ¶.html-a1ca3921.js" as="script"><link rel="prefetch" href="/assets/01-CASå’ŒUnsafeçš„APIåˆ†æ.html-612c4d6a.js" as="script"><link rel="prefetch" href="/assets/02-åŸºæœ¬ç±»å‹åŸå­ç±»AtomicLong.html-4083b8fd.js" as="script"><link rel="prefetch" href="/assets/03-å¼•ç”¨ç±»å‹åŸå­ç±»AtomicReference.html-8442553d.js" as="script"><link rel="prefetch" href="/assets/04-åŸå­æ•°ç»„ç±»AtomicLongArray.html-74e4c741.js" as="script"><link rel="prefetch" href="/assets/05-åŸå­æ“ä½œç±»AtomicReferenceFieldUpdater.html-d0310b2a.js" as="script"><link rel="prefetch" href="/assets/06-é«˜æ€§èƒ½åŸå­ç±»LongAdder.html-d6e3da8b.js" as="script"><link rel="prefetch" href="/assets/07-LockSupportåˆ†æ.html-8117dd17.js" as="script"><link rel="prefetch" href="/assets/08-AQSç®€å•ä»‹ç».html-30b6ef5b.js" as="script"><link rel="prefetch" href="/assets/09-åŸºäºReentrantLockåˆ†æAQSçš„ç‹¬å æ¨¡å¼.html-2423c430.js" as="script"><link rel="prefetch" href="/assets/10-åŸºäºCountDownLatchåˆ†æAQSçš„å…±äº«æ¨¡å¼.html-91ef4833.js" as="script"><link rel="prefetch" href="/assets/11-AQSçš„Conditionæœºåˆ¶.html-836364af.js" as="script"><link rel="prefetch" href="/assets/12-ä¿¡å·é‡Semaphore.html-3509682c.js" as="script"><link rel="prefetch" href="/assets/13-å¾ªç¯æ æ …CyclicBarrier.html-812d137d.js" as="script"><link rel="prefetch" href="/assets/14-é˜¶æ®µPhaser.html-d684f4a1.js" as="script"><link rel="prefetch" href="/assets/15-äº¤æ¢Exchanger.html-b9bf24f3.js" as="script"><link rel="prefetch" href="/assets/16-è¯»å†™é”ReentrantReadWriteLock.html-de44a1d3.js" as="script"><link rel="prefetch" href="/assets/17-Futureæ¨¡å¼-FutureTask.html-641c6250.js" as="script"><link rel="prefetch" href="/assets/18-çº¿ç¨‹æ± ä½“ç³»æ¦‚è¿°.html-dbcc52e5.js" as="script"><link rel="prefetch" href="/assets/19-çº¿ç¨‹æ± ä½“ç³»-AbstractExecutorService.html-fbd70afb.js" as="script"><link rel="prefetch" href="/assets/20-çº¿ç¨‹æ± ä½“ç³»-ThreadPoolExecutor.html-a274637a.js" as="script"><link rel="prefetch" href="/assets/21-çº¿ç¨‹æ± ä½“ç³»-ScheduledThreadPoolExecutor.html-707ffd40.js" as="script"><link rel="prefetch" href="/assets/22-CopyOnWriteArrayListå†™æ—¶å¤åˆ¶.html-914977b9.js" as="script"><link rel="prefetch" href="/assets/23-CopyOnWriteArraySetå†™æ—¶å¤åˆ¶.html-6c9c3cf6.js" as="script"><link rel="prefetch" href="/assets/24-ConcurrentSkipListMapè·³è¡¨.html-6cff54bf.js" as="script"><link rel="prefetch" href="/assets/25-ConcurrentSkipListSetè·³è¡¨.html-36cf4f7d.js" as="script"><link rel="prefetch" href="/assets/26-ConcurrentHashMapæºç åˆ†æ.html-a3bba8a9.js" as="script"><link rel="prefetch" href="/assets/27-é˜»å¡é˜Ÿåˆ—ArrayBlockingQueue.html-cd091357.js" as="script"><link rel="prefetch" href="/assets/28-é˜»å¡é˜Ÿåˆ—LinkedBlockingQueue.html-d3579ee7.js" as="script"><link rel="prefetch" href="/assets/29-é˜»å¡é˜Ÿåˆ—LinkedBlockingDeque.html-32c13680.js" as="script"><link rel="prefetch" href="/assets/30-é˜»å¡é˜Ÿåˆ—PriorityBlockingQueue.html-b5455c77.js" as="script"><link rel="prefetch" href="/assets/31-é˜»å¡é˜Ÿåˆ—DelayQueue.html-7759c195.js" as="script"><link rel="prefetch" href="/assets/32-é˜»å¡é˜Ÿåˆ—SynchronousQueue.html-97ed879a.js" as="script"><link rel="prefetch" href="/assets/33-é˜»å¡é˜Ÿåˆ—LinkedTransferQueue.html-3281c1b4.js" as="script"><link rel="prefetch" href="/assets/index.html-f5239cf3.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis01ï¼šmyabtisçš„æ•´ä½“æ¶æ„.html-f25c0705.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis02ï¼šå…¥é—¨æ¡ˆä¾‹.html-30e68cd3.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis03ï¼šè§£æå…¨å±€é…ç½®æ–‡ä»¶.html-2db85266.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis04ï¼šè§£æMapperæ˜ å°„æ–‡ä»¶.html-60756a5b.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis05ï¼šè§£æStatementæ“ä½œèŠ‚ç‚¹.html-31e11b60.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis06ï¼šè§£æSQLè¯­å¥.html-a9181b56.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis07ï¼šJavaæ–¹æ³•å’ŒSQLè¯­å¥ç»‘å®š.html-9bfa3db6.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis08ï¼šè·å¾—SqlSession.html-e2a92940.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis09ï¼šExecutoræ‰§è¡Œå™¨.html-ad701715.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis10ï¼šç¼“å­˜æœºåˆ¶.html-f2daa10c.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis11ï¼šStatementHandler.html-95b30d9b.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis12ï¼šå‚æ•°è§£æå’Œèµ‹å€¼.html-5778c0ea.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis13ï¼šç»“æœé›†å¤„ç†.html-2ff72779.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis14ï¼šæ’ä»¶.html-76cc6bf8.js" as="script"><link rel="prefetch" href="/assets/01-æœåŠ¡ç«¯å¯åŠ¨æµç¨‹.html-d2fc1f19.js" as="script"><link rel="prefetch" href="/assets/02-æœåŠ¡ç«¯å¯åŠ¨æ·»åŠ ChannelInitializeråˆ°ç®¡é“.html-86cb5d6a.js" as="script"><link rel="prefetch" href="/assets/03-å®¢æˆ·ç«¯å¯åŠ¨æµç¨‹.html-becc83be.js" as="script"><link rel="prefetch" href="/assets/04-çº¿ç¨‹ä½“ç³»-NioEventLoopGroup.html-700e797e.js" as="script"><link rel="prefetch" href="/assets/05-çº¿ç¨‹ä½“ç³»-NioEventLoopç›¸å…³çˆ¶æ¥å£åˆ†æ.html-754320bc.js" as="script"><link rel="prefetch" href="/assets/06-çº¿ç¨‹ä½“ç³»-AbstractEventExecutor.html-5250cd42.js" as="script"><link rel="prefetch" href="/assets/07-çº¿ç¨‹ä½“ç³»-AbstractScheduledEventExecutor-ä¼˜å…ˆé˜Ÿåˆ—.html-e7bbaf32.js" as="script"><link rel="prefetch" href="/assets/08-çº¿ç¨‹ä½“ç³»-NioEventLoopæ¦‚è¿°.html-fce3fb2c.js" as="script"><link rel="prefetch" href="/assets/09-çº¿ç¨‹ä½“ç³»-NioEventLoopå¼€å¯SelectoråŠä¼˜åŒ–.html-6d8230cf.js" as="script"><link rel="prefetch" href="/assets/10-çº¿ç¨‹ä½“ç³»-NioEventLoopç»‘å®šçº¿ç¨‹.html-db947821.js" as="script"><link rel="prefetch" href="/assets/11-çº¿ç¨‹ä½“ç³»-NioEventLoopçš„runæ–¹æ³•.html-def4cc31.js" as="script"><link rel="prefetch" href="/assets/12-çº¿ç¨‹ä½“ç³»-NioEventLoopè§„é¿JDKçš„NIOç©ºå¾ªç¯bug.html-16ecaf4e.js" as="script"><link rel="prefetch" href="/assets/13-çº¿ç¨‹ä½“ç³»-NioEventLoopçš„ä¼˜é›…å…³é—­.html-912d668d.js" as="script"><link rel="prefetch" href="/assets/14-æœåŠ¡ç«¯å¤„ç†å®¢æˆ·ç«¯çš„è¿æ¥(ACCEPT).html-63afdec1.js" as="script"><link rel="prefetch" href="/assets/15-å®¢æˆ·ç«¯å¤„ç†READäº‹ä»¶æ¦‚è¿°.html-b35daeb8.js" as="script"><link rel="prefetch" href="/assets/16-å®¢æˆ·ç«¯å¤„ç†READäº‹ä»¶è¯¦è§£åŠRecvByteBufAllocator.html-a9faccfa.js" as="script"><link rel="prefetch" href="/assets/17-Nettyç®¡é“æœºåˆ¶.html-ba70b238.js" as="script"><link rel="prefetch" href="/assets/18-Nettyå‘é€æ•°æ®æµç¨‹åŠå‡ºç«™ç¼“å†²åŒº.html-223d04a7.js" as="script"><link rel="prefetch" href="/assets/index.html-b475d8b0.js" as="script"><link rel="prefetch" href="/assets/Redis_BenchmarkåŸºå‡†æµ‹è¯•.html-dbf21951.js" as="script"><link rel="prefetch" href="/assets/Redis_Clusteré›†ç¾¤å’Œæ§½ç®¡ç†å‘½ä»¤.html-2b4a1244.js" as="script"><link rel="prefetch" href="/assets/Redis_Clusteré›†ç¾¤åŸºæœ¬ç‰¹æ€§å’Œé›†ç¾¤æ­å»º.html-42be726b.js" as="script"><link rel="prefetch" href="/assets/Redis_Clusteré›†ç¾¤ç®¡ç†å·¥å…·redis-cli.html-fc4f1503.js" as="script"><link rel="prefetch" href="/assets/Redis_Pipelineä¼˜åŒ–RTT.html-8a4aa041.js" as="script"><link rel="prefetch" href="/assets/Redis_Sentinelé«˜å¯ç”¨.html-6bcdb34a.js" as="script"><link rel="prefetch" href="/assets/Redis_keyè®¾è®¡è§„èŒƒ.html-ab90a7dc.js" as="script"><link rel="prefetch" href="/assets/Redisäº‹åŠ¡.html-e43061e1.js" as="script"><link rel="prefetch" href="/assets/Rediså†…å­˜æ·˜æ±°ç­–ç•¥.html-feabd314.js" as="script"><link rel="prefetch" href="/assets/Rediså‘å¸ƒè®¢é˜….html-68771977.js" as="script"><link rel="prefetch" href="/assets/Rediså¤åˆ¶.html-33b20d6f.js" as="script"><link rel="prefetch" href="/assets/Rediså¤§keyå’Œçƒ­keyé—®é¢˜.html-394d194e.js" as="script"><link rel="prefetch" href="/assets/Redisæ…¢æŸ¥è¯¢æ—¥å¿—.html-7fb06db0.js" as="script"><link rel="prefetch" href="/assets/Redisé”®ç©ºé—´é€šçŸ¥(keyspace notification).html-012bd277.js" as="script"><link rel="prefetch" href="/assets/redis-cli ä½¿ç”¨.html-f7ab22db.js" as="script"><link rel="prefetch" href="/assets/01-RocketMQæ¦‚è¿°.html-25463efe.js" as="script"><link rel="prefetch" href="/assets/02-NameServerå¯åŠ¨æµç¨‹.html-a514999f.js" as="script"><link rel="prefetch" href="/assets/03-Brokerå¯åŠ¨æµç¨‹.html-43c84806.js" as="script"><link rel="prefetch" href="/assets/04-RocketMQç½‘ç»œé€šä¿¡åŸç†.html-ac88de8d.js" as="script"><link rel="prefetch" href="/assets/05-RocketMQ æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„å¯åŠ¨.html-ef7f1888.js" as="script"><link rel="prefetch" href="/assets/06-RocketMQç½‘ç»œé€šä¿¡æºç .html-b8e0bf43.js" as="script"><link rel="prefetch" href="/assets/07-NameServerä½œç”¨å’Œè·¯ç”±å…ƒä¿¡æ¯.html-82a23869.js" as="script"><link rel="prefetch" href="/assets/08-NameServerè·¯ç”±ç®¡ç†æºç åˆ†æ.html-8da2bd72.js" as="script"><link rel="prefetch" href="/assets/09-ç”Ÿäº§è€…ç›¸å…³ç±»åˆ†æ.html-08f6e840.js" as="script"><link rel="prefetch" href="/assets/10-ç”Ÿäº§è€…å¯åŠ¨æµç¨‹.html-d761cf07.js" as="script"><link rel="prefetch" href="/assets/11-ç”Ÿäº§è€…å‘é€æ¶ˆæ¯.html-743328bc.js" as="script"><link rel="prefetch" href="/assets/12-Brokerå­˜å‚¨æœºåˆ¶æ¦‚è¿°.html-5e7ed491.js" as="script"><link rel="prefetch" href="/assets/13-MappedFileå’ŒMappedFileQueueåˆ†æ.html-5b9afaf2.js" as="script"><link rel="prefetch" href="/assets/14-CommitLogåŸç†åˆ†æ.html-93362aa2.js" as="script"><link rel="prefetch" href="/assets/15-brokerçš„åˆ·ç›˜æœºåˆ¶.html-21e2029f.js" as="script"><link rel="prefetch" href="/assets/16-ConsumeQueueå’ŒIndexåŸç†åˆ†æ.html-ff18bade.js" as="script"><link rel="prefetch" href="/assets/17-brokerè¿‡æœŸæ–‡ä»¶åˆ é™¤æœºåˆ¶.html-89f05919.js" as="script"><link rel="prefetch" href="/assets/18-æ¶ˆè´¹è€…å¯åŠ¨æµç¨‹(TODO).html-988c43b3.js" as="script"><link rel="prefetch" href="/assets/19-æ¶ˆæ¯æ‹‰å–å…¥å£å’Œæ¶ˆæ¯é˜Ÿåˆ—è´Ÿè½½å‡è¡¡.html-7e4e20d4.js" as="script"><link rel="prefetch" href="/assets/20-æ¶ˆè´¹è€…å‘é€æ¶ˆæ¯æ‹‰å–è¯·æ±‚æµç¨‹.html-19825069.js" as="script"><link rel="prefetch" href="/assets/21-brokerå¤„ç†æ¶ˆæ¯æ‹‰å–è¯·æ±‚-1-ä¸»æµç¨‹.html-d9ca6fa4.js" as="script"><link rel="prefetch" href="/assets/22-brokerå¤„ç†æ¶ˆæ¯æ‹‰å–è¯·æ±‚-2-é•¿è½®è¯¢.html-0aba4f38.js" as="script"><link rel="prefetch" href="/assets/23-brokerå¤„ç†æ¶ˆæ¯æ‹‰å–è¯·æ±‚-3-è¯»å–æ¶ˆæ¯.html-729d741b.js" as="script"><link rel="prefetch" href="/assets/24-æ¶ˆè´¹è€…å¤„ç†ä»brokeræ‹‰å–çš„æ¶ˆæ¯.html-dcfb7d07.js" as="script"><link rel="prefetch" href="/assets/25-å¹¶å‘æ¶ˆè´¹åŸç†.html-5ef206ec.js" as="script"><link rel="prefetch" href="/assets/001-æœåŠ¡å™¨CPUé—®é¢˜-è§„å¾‹æ€§å³°åˆº.html-81aeb2c9.js" as="script"><link rel="prefetch" href="/assets/002-æœåŠ¡å™¨CPUé…ç½®é™ä½GCåˆ†æ.html-d27479f5.js" as="script"><link rel="prefetch" href="/assets/003-æœåŠ¡å™¨CPUä½¿ç”¨ç‡è¾ƒä½ä½†ç³»ç»Ÿè´Ÿè½½é«˜.html-13cce7d9.js" as="script"><link rel="prefetch" href="/assets/004-log4j2å†…å­˜æ³„éœ²å¯¼è‡´çš„é¢‘ç¹fullgc.html-a403b9d0.js" as="script"><link rel="prefetch" href="/assets/005-çº¿ç¨‹æ± çˆ¶å­ä»»åŠ¡ä½¿ç”¨ä¸å½“é€ æˆæ­»é”.html-362015fc.js" as="script"><link rel="prefetch" href="/assets/006-linuxç³»ç»Ÿå‚æ•°-è¿æ¥é˜Ÿåˆ—é•¿åº¦è¿‡å°å¯¼è‡´è¿æ¥ä¸¢å¼ƒ.html-7c9d02a0.js" as="script"><link rel="prefetch" href="/assets/007-redisé¢‘ç¹æ·˜æ±°-æ¸…é™¤redisçº¿ä¸Šæœªè®¾ç½®è¿‡æœŸæ—¶é—´çš„key.html-e760378c.js" as="script"><link rel="prefetch" href="/assets/é¡¹ç›®-IMé•¿è¿æ¥ä¼˜åŒ–.html-00c51a2b.js" as="script"><link rel="prefetch" href="/assets/é¡¹ç›®-æœåŠ¡é™çº§.html-6240bf01.js" as="script"><link rel="prefetch" href="/assets/é¡¹ç›®-ç›´æ’­é—´ä¸šåŠ¡å¤šçº§ç¼“å­˜ä¼˜åŒ–.html-dbde2ae9.js" as="script"><link rel="prefetch" href="/assets/é¡¹ç›®-çº¿ç¨‹æ± ä¼˜åŒ–.html-c4acfb51.js" as="script"><link rel="prefetch" href="/assets/JUCç›¸å…³é—®é¢˜.html-9dc4b717.js" as="script"><link rel="prefetch" href="/assets/JVMé—®é¢˜.html-17300c49.js" as="script"><link rel="prefetch" href="/assets/MySQLç›¸å…³é—®é¢˜.html-a6c2cd41.js" as="script"><link rel="prefetch" href="/assets/index.html-8f5e683a.js" as="script"><link rel="prefetch" href="/assets/Redisç›¸å…³é—®é¢˜.html-575f1ee1.js" as="script"><link rel="prefetch" href="/assets/äºŒåˆ†æŸ¥æ‰¾.html-6b017c38.js" as="script"><link rel="prefetch" href="/assets/äºŒå‰æ ‘.html-e277f749.js" as="script"><link rel="prefetch" href="/assets/ä»£ç éšæƒ³å½•é¢˜ç›®ç›®å½•.html-308825f0.js" as="script"><link rel="prefetch" href="/assets/HowToSayResume.html-1d15b1ef.js" as="script"><link rel="prefetch" href="/assets/index.html-af6a830f.js" as="script"><link rel="prefetch" href="/assets/resume.html-3b3f8934.js" as="script"><link rel="prefetch" href="/assets/404.html-f3795607.js" as="script"><link rel="prefetch" href="/assets/index.html-1f3390c0.js" as="script"><link rel="prefetch" href="/assets/index.html-10b45510.js" as="script"><link rel="prefetch" href="/assets/index.html-dfd17ea5.js" as="script"><link rel="prefetch" href="/assets/index.html-2f392b9e.js" as="script"><link rel="prefetch" href="/assets/index.html-4060f68d.js" as="script"><link rel="prefetch" href="/assets/index.html-d5cde66b.js" as="script"><link rel="prefetch" href="/assets/index.html-98628ecf.js" as="script"><link rel="prefetch" href="/assets/01-åˆ›å»ºå’Œé”€æ¯å¯¹è±¡.html-98880c0b.js" as="script"><link rel="prefetch" href="/assets/index.html-289fbe8c.js" as="script"><link rel="prefetch" href="/assets/SPIæœºåˆ¶.html-6e0cbff0.js" as="script"><link rel="prefetch" href="/assets/01-CASå’ŒUnsafeçš„APIåˆ†æ.html-284105ba.js" as="script"><link rel="prefetch" href="/assets/02-åŸºæœ¬ç±»å‹åŸå­ç±»AtomicLong.html-494b1548.js" as="script"><link rel="prefetch" href="/assets/03-å¼•ç”¨ç±»å‹åŸå­ç±»AtomicReference.html-ccc050fe.js" as="script"><link rel="prefetch" href="/assets/04-åŸå­æ•°ç»„ç±»AtomicLongArray.html-f2ab5761.js" as="script"><link rel="prefetch" href="/assets/05-åŸå­æ“ä½œç±»AtomicReferenceFieldUpdater.html-d1c4c5ff.js" as="script"><link rel="prefetch" href="/assets/06-é«˜æ€§èƒ½åŸå­ç±»LongAdder.html-e5773519.js" as="script"><link rel="prefetch" href="/assets/07-LockSupportåˆ†æ.html-1b81e0e2.js" as="script"><link rel="prefetch" href="/assets/08-AQSç®€å•ä»‹ç».html-f23f0607.js" as="script"><link rel="prefetch" href="/assets/09-åŸºäºReentrantLockåˆ†æAQSçš„ç‹¬å æ¨¡å¼.html-ca778978.js" as="script"><link rel="prefetch" href="/assets/10-åŸºäºCountDownLatchåˆ†æAQSçš„å…±äº«æ¨¡å¼.html-1f21993b.js" as="script"><link rel="prefetch" href="/assets/11-AQSçš„Conditionæœºåˆ¶.html-6455740a.js" as="script"><link rel="prefetch" href="/assets/12-ä¿¡å·é‡Semaphore.html-1ebc2dec.js" as="script"><link rel="prefetch" href="/assets/13-å¾ªç¯æ æ …CyclicBarrier.html-cd272366.js" as="script"><link rel="prefetch" href="/assets/14-é˜¶æ®µPhaser.html-6d73b77d.js" as="script"><link rel="prefetch" href="/assets/15-äº¤æ¢Exchanger.html-ff0d61a8.js" as="script"><link rel="prefetch" href="/assets/16-è¯»å†™é”ReentrantReadWriteLock.html-48b1d598.js" as="script"><link rel="prefetch" href="/assets/17-Futureæ¨¡å¼-FutureTask.html-33bc315c.js" as="script"><link rel="prefetch" href="/assets/18-çº¿ç¨‹æ± ä½“ç³»æ¦‚è¿°.html-7b7662f6.js" as="script"><link rel="prefetch" href="/assets/19-çº¿ç¨‹æ± ä½“ç³»-AbstractExecutorService.html-0005c0e9.js" as="script"><link rel="prefetch" href="/assets/20-çº¿ç¨‹æ± ä½“ç³»-ThreadPoolExecutor.html-58827d6b.js" as="script"><link rel="prefetch" href="/assets/21-çº¿ç¨‹æ± ä½“ç³»-ScheduledThreadPoolExecutor.html-fecdf1d0.js" as="script"><link rel="prefetch" href="/assets/22-CopyOnWriteArrayListå†™æ—¶å¤åˆ¶.html-f1dbc699.js" as="script"><link rel="prefetch" href="/assets/23-CopyOnWriteArraySetå†™æ—¶å¤åˆ¶.html-0cc43a92.js" as="script"><link rel="prefetch" href="/assets/24-ConcurrentSkipListMapè·³è¡¨.html-149e2f97.js" as="script"><link rel="prefetch" href="/assets/25-ConcurrentSkipListSetè·³è¡¨.html-d6609ef6.js" as="script"><link rel="prefetch" href="/assets/26-ConcurrentHashMapæºç åˆ†æ.html-ebf8c75a.js" as="script"><link rel="prefetch" href="/assets/27-é˜»å¡é˜Ÿåˆ—ArrayBlockingQueue.html-037b1715.js" as="script"><link rel="prefetch" href="/assets/28-é˜»å¡é˜Ÿåˆ—LinkedBlockingQueue.html-6c720f6f.js" as="script"><link rel="prefetch" href="/assets/29-é˜»å¡é˜Ÿåˆ—LinkedBlockingDeque.html-fc5a5288.js" as="script"><link rel="prefetch" href="/assets/30-é˜»å¡é˜Ÿåˆ—PriorityBlockingQueue.html-9f9e0967.js" as="script"><link rel="prefetch" href="/assets/31-é˜»å¡é˜Ÿåˆ—DelayQueue.html-63ce1a75.js" as="script"><link rel="prefetch" href="/assets/32-é˜»å¡é˜Ÿåˆ—SynchronousQueue.html-c70c3f56.js" as="script"><link rel="prefetch" href="/assets/33-é˜»å¡é˜Ÿåˆ—LinkedTransferQueue.html-f4950cb5.js" as="script"><link rel="prefetch" href="/assets/index.html-8df5d6cb.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis01ï¼šmyabtisçš„æ•´ä½“æ¶æ„.html-f42c3109.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis02ï¼šå…¥é—¨æ¡ˆä¾‹.html-73c184cc.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis03ï¼šè§£æå…¨å±€é…ç½®æ–‡ä»¶.html-f4710051.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis04ï¼šè§£æMapperæ˜ å°„æ–‡ä»¶.html-35382622.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis05ï¼šè§£æStatementæ“ä½œèŠ‚ç‚¹.html-32ac534b.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis06ï¼šè§£æSQLè¯­å¥.html-53e62751.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis07ï¼šJavaæ–¹æ³•å’ŒSQLè¯­å¥ç»‘å®š.html-41ff933c.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis08ï¼šè·å¾—SqlSession.html-da483749.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis09ï¼šExecutoræ‰§è¡Œå™¨.html-017e8e74.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis10ï¼šç¼“å­˜æœºåˆ¶.html-8fb1da9d.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis11ï¼šStatementHandler.html-f78b3b07.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis12ï¼šå‚æ•°è§£æå’Œèµ‹å€¼.html-ff11d8e9.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis13ï¼šç»“æœé›†å¤„ç†.html-321ab25a.js" as="script"><link rel="prefetch" href="/assets/æ·±å…¥æµ…å‡ºMybatis14ï¼šæ’ä»¶.html-3a3dee77.js" as="script"><link rel="prefetch" href="/assets/01-æœåŠ¡ç«¯å¯åŠ¨æµç¨‹.html-a1008297.js" as="script"><link rel="prefetch" href="/assets/02-æœåŠ¡ç«¯å¯åŠ¨æ·»åŠ ChannelInitializeråˆ°ç®¡é“.html-33bda871.js" as="script"><link rel="prefetch" href="/assets/03-å®¢æˆ·ç«¯å¯åŠ¨æµç¨‹.html-43244bd7.js" as="script"><link rel="prefetch" href="/assets/04-çº¿ç¨‹ä½“ç³»-NioEventLoopGroup.html-3eead46d.js" as="script"><link rel="prefetch" href="/assets/05-çº¿ç¨‹ä½“ç³»-NioEventLoopç›¸å…³çˆ¶æ¥å£åˆ†æ.html-f0c359cf.js" as="script"><link rel="prefetch" href="/assets/06-çº¿ç¨‹ä½“ç³»-AbstractEventExecutor.html-425c5349.js" as="script"><link rel="prefetch" href="/assets/07-çº¿ç¨‹ä½“ç³»-AbstractScheduledEventExecutor-ä¼˜å…ˆé˜Ÿåˆ—.html-eb9d9201.js" as="script"><link rel="prefetch" href="/assets/08-çº¿ç¨‹ä½“ç³»-NioEventLoopæ¦‚è¿°.html-2a8b1fb4.js" as="script"><link rel="prefetch" href="/assets/09-çº¿ç¨‹ä½“ç³»-NioEventLoopå¼€å¯SelectoråŠä¼˜åŒ–.html-041c39ec.js" as="script"><link rel="prefetch" href="/assets/10-çº¿ç¨‹ä½“ç³»-NioEventLoopç»‘å®šçº¿ç¨‹.html-9430fb3d.js" as="script"><link rel="prefetch" href="/assets/11-çº¿ç¨‹ä½“ç³»-NioEventLoopçš„runæ–¹æ³•.html-3c1e213f.js" as="script"><link rel="prefetch" href="/assets/12-çº¿ç¨‹ä½“ç³»-NioEventLoopè§„é¿JDKçš„NIOç©ºå¾ªç¯bug.html-76b1941a.js" as="script"><link rel="prefetch" href="/assets/13-çº¿ç¨‹ä½“ç³»-NioEventLoopçš„ä¼˜é›…å…³é—­.html-bf5a12d7.js" as="script"><link rel="prefetch" href="/assets/14-æœåŠ¡ç«¯å¤„ç†å®¢æˆ·ç«¯çš„è¿æ¥(ACCEPT).html-01aec071.js" as="script"><link rel="prefetch" href="/assets/15-å®¢æˆ·ç«¯å¤„ç†READäº‹ä»¶æ¦‚è¿°.html-b5afa99b.js" as="script"><link rel="prefetch" href="/assets/16-å®¢æˆ·ç«¯å¤„ç†READäº‹ä»¶è¯¦è§£åŠRecvByteBufAllocator.html-e0277a81.js" as="script"><link rel="prefetch" href="/assets/17-Nettyç®¡é“æœºåˆ¶.html-2cf2d42f.js" as="script"><link rel="prefetch" href="/assets/18-Nettyå‘é€æ•°æ®æµç¨‹åŠå‡ºç«™ç¼“å†²åŒº.html-5c4b745b.js" as="script"><link rel="prefetch" href="/assets/index.html-a6f98898.js" as="script"><link rel="prefetch" href="/assets/Redis_BenchmarkåŸºå‡†æµ‹è¯•.html-e039b7fc.js" as="script"><link rel="prefetch" href="/assets/Redis_Clusteré›†ç¾¤å’Œæ§½ç®¡ç†å‘½ä»¤.html-1f29cf36.js" as="script"><link rel="prefetch" href="/assets/Redis_Clusteré›†ç¾¤åŸºæœ¬ç‰¹æ€§å’Œé›†ç¾¤æ­å»º.html-a58e3d14.js" as="script"><link rel="prefetch" href="/assets/Redis_Clusteré›†ç¾¤ç®¡ç†å·¥å…·redis-cli.html-8ccf9df0.js" as="script"><link rel="prefetch" href="/assets/Redis_Pipelineä¼˜åŒ–RTT.html-80b0f1bb.js" as="script"><link rel="prefetch" href="/assets/Redis_Sentinelé«˜å¯ç”¨.html-7550d7f8.js" as="script"><link rel="prefetch" href="/assets/Redis_keyè®¾è®¡è§„èŒƒ.html-5e311710.js" as="script"><link rel="prefetch" href="/assets/Redisäº‹åŠ¡.html-373a5c1f.js" as="script"><link rel="prefetch" href="/assets/Rediså†…å­˜æ·˜æ±°ç­–ç•¥.html-db334f1c.js" as="script"><link rel="prefetch" href="/assets/Rediså‘å¸ƒè®¢é˜….html-1760c6e3.js" as="script"><link rel="prefetch" href="/assets/Rediså¤åˆ¶.html-d202bca3.js" as="script"><link rel="prefetch" href="/assets/Rediså¤§keyå’Œçƒ­keyé—®é¢˜.html-fb006685.js" as="script"><link rel="prefetch" href="/assets/Redisæ…¢æŸ¥è¯¢æ—¥å¿—.html-c88902c4.js" as="script"><link rel="prefetch" href="/assets/Redisé”®ç©ºé—´é€šçŸ¥(keyspace notification).html-ed144c49.js" as="script"><link rel="prefetch" href="/assets/redis-cli ä½¿ç”¨.html-f82ec96e.js" as="script"><link rel="prefetch" href="/assets/01-RocketMQæ¦‚è¿°.html-bc19ff12.js" as="script"><link rel="prefetch" href="/assets/02-NameServerå¯åŠ¨æµç¨‹.html-7cf2deaa.js" as="script"><link rel="prefetch" href="/assets/03-Brokerå¯åŠ¨æµç¨‹.html-435c7cd0.js" as="script"><link rel="prefetch" href="/assets/04-RocketMQç½‘ç»œé€šä¿¡åŸç†.html-56400db4.js" as="script"><link rel="prefetch" href="/assets/05-RocketMQ æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„å¯åŠ¨.html-1eb800a4.js" as="script"><link rel="prefetch" href="/assets/06-RocketMQç½‘ç»œé€šä¿¡æºç .html-0cf49d23.js" as="script"><link rel="prefetch" href="/assets/07-NameServerä½œç”¨å’Œè·¯ç”±å…ƒä¿¡æ¯.html-b53155de.js" as="script"><link rel="prefetch" href="/assets/08-NameServerè·¯ç”±ç®¡ç†æºç åˆ†æ.html-3ae1ea83.js" as="script"><link rel="prefetch" href="/assets/09-ç”Ÿäº§è€…ç›¸å…³ç±»åˆ†æ.html-05bebd84.js" as="script"><link rel="prefetch" href="/assets/10-ç”Ÿäº§è€…å¯åŠ¨æµç¨‹.html-763ba809.js" as="script"><link rel="prefetch" href="/assets/11-ç”Ÿäº§è€…å‘é€æ¶ˆæ¯.html-3d115318.js" as="script"><link rel="prefetch" href="/assets/12-Brokerå­˜å‚¨æœºåˆ¶æ¦‚è¿°.html-de98231f.js" as="script"><link rel="prefetch" href="/assets/13-MappedFileå’ŒMappedFileQueueåˆ†æ.html-44b33d1e.js" as="script"><link rel="prefetch" href="/assets/14-CommitLogåŸç†åˆ†æ.html-e2d868d1.js" as="script"><link rel="prefetch" href="/assets/15-brokerçš„åˆ·ç›˜æœºåˆ¶.html-7a4bfc45.js" as="script"><link rel="prefetch" href="/assets/16-ConsumeQueueå’ŒIndexåŸç†åˆ†æ.html-0b34797d.js" as="script"><link rel="prefetch" href="/assets/17-brokerè¿‡æœŸæ–‡ä»¶åˆ é™¤æœºåˆ¶.html-b32b72a2.js" as="script"><link rel="prefetch" href="/assets/18-æ¶ˆè´¹è€…å¯åŠ¨æµç¨‹(TODO).html-ce4a6b08.js" as="script"><link rel="prefetch" href="/assets/19-æ¶ˆæ¯æ‹‰å–å…¥å£å’Œæ¶ˆæ¯é˜Ÿåˆ—è´Ÿè½½å‡è¡¡.html-cd53c6c0.js" as="script"><link rel="prefetch" href="/assets/20-æ¶ˆè´¹è€…å‘é€æ¶ˆæ¯æ‹‰å–è¯·æ±‚æµç¨‹.html-5ec17fab.js" as="script"><link rel="prefetch" href="/assets/21-brokerå¤„ç†æ¶ˆæ¯æ‹‰å–è¯·æ±‚-1-ä¸»æµç¨‹.html-fa68ad78.js" as="script"><link rel="prefetch" href="/assets/22-brokerå¤„ç†æ¶ˆæ¯æ‹‰å–è¯·æ±‚-2-é•¿è½®è¯¢.html-52127466.js" as="script"><link rel="prefetch" href="/assets/23-brokerå¤„ç†æ¶ˆæ¯æ‹‰å–è¯·æ±‚-3-è¯»å–æ¶ˆæ¯.html-91bd7c04.js" as="script"><link rel="prefetch" href="/assets/24-æ¶ˆè´¹è€…å¤„ç†ä»brokeræ‹‰å–çš„æ¶ˆæ¯.html-00e9cd0d.js" as="script"><link rel="prefetch" href="/assets/25-å¹¶å‘æ¶ˆè´¹åŸç†.html-c55c5572.js" as="script"><link rel="prefetch" href="/assets/001-æœåŠ¡å™¨CPUé—®é¢˜-è§„å¾‹æ€§å³°åˆº.html-2e647dca.js" as="script"><link rel="prefetch" href="/assets/002-æœåŠ¡å™¨CPUé…ç½®é™ä½GCåˆ†æ.html-44ad66b9.js" as="script"><link rel="prefetch" href="/assets/003-æœåŠ¡å™¨CPUä½¿ç”¨ç‡è¾ƒä½ä½†ç³»ç»Ÿè´Ÿè½½é«˜.html-f22e939a.js" as="script"><link rel="prefetch" href="/assets/004-log4j2å†…å­˜æ³„éœ²å¯¼è‡´çš„é¢‘ç¹fullgc.html-a76ee5ab.js" as="script"><link rel="prefetch" href="/assets/005-çº¿ç¨‹æ± çˆ¶å­ä»»åŠ¡ä½¿ç”¨ä¸å½“é€ æˆæ­»é”.html-96a0053a.js" as="script"><link rel="prefetch" href="/assets/006-linuxç³»ç»Ÿå‚æ•°-è¿æ¥é˜Ÿåˆ—é•¿åº¦è¿‡å°å¯¼è‡´è¿æ¥ä¸¢å¼ƒ.html-f535ce59.js" as="script"><link rel="prefetch" href="/assets/007-redisé¢‘ç¹æ·˜æ±°-æ¸…é™¤redisçº¿ä¸Šæœªè®¾ç½®è¿‡æœŸæ—¶é—´çš„key.html-488bc600.js" as="script"><link rel="prefetch" href="/assets/é¡¹ç›®-IMé•¿è¿æ¥ä¼˜åŒ–.html-cbc92d58.js" as="script"><link rel="prefetch" href="/assets/é¡¹ç›®-æœåŠ¡é™çº§.html-619ec446.js" as="script"><link rel="prefetch" href="/assets/é¡¹ç›®-ç›´æ’­é—´ä¸šåŠ¡å¤šçº§ç¼“å­˜ä¼˜åŒ–.html-23c27db0.js" as="script"><link rel="prefetch" href="/assets/é¡¹ç›®-çº¿ç¨‹æ± ä¼˜åŒ–.html-3fcc815b.js" as="script"><link rel="prefetch" href="/assets/JUCç›¸å…³é—®é¢˜.html-b9582a76.js" as="script"><link rel="prefetch" href="/assets/JVMé—®é¢˜.html-259c02ad.js" as="script"><link rel="prefetch" href="/assets/MySQLç›¸å…³é—®é¢˜.html-1cff772c.js" as="script"><link rel="prefetch" href="/assets/index.html-7e212d6e.js" as="script"><link rel="prefetch" href="/assets/Redisç›¸å…³é—®é¢˜.html-fba976f1.js" as="script"><link rel="prefetch" href="/assets/äºŒåˆ†æŸ¥æ‰¾.html-74d51a59.js" as="script"><link rel="prefetch" href="/assets/äºŒå‰æ ‘.html-cc439339.js" as="script"><link rel="prefetch" href="/assets/ä»£ç éšæƒ³å½•é¢˜ç›®ç›®å½•.html-dc57c32e.js" as="script"><link rel="prefetch" href="/assets/HowToSayResume.html-a97986f1.js" as="script"><link rel="prefetch" href="/assets/index.html-500751d8.js" as="script"><link rel="prefetch" href="/assets/resume.html-bd25fb30.js" as="script"><link rel="prefetch" href="/assets/404.html-60b61471.js" as="script"><link rel="prefetch" href="/assets/index.html-a7a67f1a.js" as="script"><link rel="prefetch" href="/assets/index.html-e5f8081b.js" as="script"><link rel="prefetch" href="/assets/index.html-0a1d7321.js" as="script"><link rel="prefetch" href="/assets/index.html-8f151841.js" as="script"><link rel="prefetch" href="/assets/index.html-08e92e8f.js" as="script"><link rel="prefetch" href="/assets/index.html-d5207d5f.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-2450701e.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a href="/" class="vp-brand"><img class="vp-nav-logo" src="/å°ç†ŠçŒ«.png" alt><!----><!----></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><!----><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><!--[--><a href="/Redis/Redis_Benchmark%E5%9F%BA%E5%87%86%E6%B5%8B%E8%AF%95.html" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="Redis BenchmarkåŸºå‡†æµ‹è¯•"><!---->Redis BenchmarkåŸºå‡†æµ‹è¯•<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Redis/Redis_Cluster%E9%9B%86%E7%BE%A4%E5%92%8C%E6%A7%BD%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4.html" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="Redis Clusteré›†ç¾¤å’Œæ§½ç®¡ç†å‘½ä»¤"><!---->Redis Clusteré›†ç¾¤å’Œæ§½ç®¡ç†å‘½ä»¤<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Redis/Redis_Cluster%E9%9B%86%E7%BE%A4%E5%9F%BA%E6%9C%AC%E7%89%B9%E6%80%A7%E5%92%8C%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA.html" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="Redis Clusteré›†ç¾¤åŸºæœ¬ç‰¹æ€§å’Œé›†ç¾¤æ­å»º"><!---->Redis Clusteré›†ç¾¤åŸºæœ¬ç‰¹æ€§å’Œé›†ç¾¤æ­å»º<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Redis/Redis_Cluster%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7redis-cli.html" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="Redis Clusteré›†ç¾¤ç®¡ç†å·¥å…·redis-cli"><!---->Redis Clusteré›†ç¾¤ç®¡ç†å·¥å…·redis-cli<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Redis/Redis_key%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83.html" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="Redis keyè®¾è®¡è§„èŒƒ"><!---->Redis keyè®¾è®¡è§„èŒƒ<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Redis/Redis_Pipeline%E4%BC%98%E5%8C%96RTT.html" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="Redis Pipelineä¼˜åŒ–RTT"><!---->Redis Pipelineä¼˜åŒ–RTT<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Redis/Redis_Sentinel%E9%AB%98%E5%8F%AF%E7%94%A8.html" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="Redis Sentinelé«˜å¯ç”¨"><!---->Redis Sentinelé«˜å¯ç”¨<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Redis/redis-cli%20%E4%BD%BF%E7%94%A8.html" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="redis-cliä½¿ç”¨"><!---->redis-cliä½¿ç”¨<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Redis/Redis%E4%BA%8B%E5%8A%A1.html" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="Redisäº‹åŠ¡"><!---->Redisäº‹åŠ¡<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Redis/Redis%E5%86%85%E5%AD%98%E6%B7%98%E6%B1%B0%E7%AD%96%E7%95%A5.html" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="Rediså†…å­˜æ·˜æ±°ç­–ç•¥"><!---->Rediså†…å­˜æ·˜æ±°ç­–ç•¥<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Redis/Redis%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85.html" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="Rediså‘å¸ƒè®¢é˜…"><!---->Rediså‘å¸ƒè®¢é˜…<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Redis/Redis%E5%A4%8D%E5%88%B6.html" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="Rediså¤åˆ¶"><!---->Rediså¤åˆ¶<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Redis/Redis%E5%A4%A7key%E5%92%8C%E7%83%ADkey%E9%97%AE%E9%A2%98.html" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="Rediså¤§keyå’Œçƒ­keyé—®é¢˜"><!---->Rediså¤§keyå’Œçƒ­keyé—®é¢˜<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Redis/Redis%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97.html" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="Redisæ…¢æŸ¥è¯¢æ—¥å¿—"><!---->Redisæ…¢æŸ¥è¯¢æ—¥å¿—<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html" class="router-link-active router-link-exact-active nav-link active vp-sidebar-link vp-sidebar-page active" aria-label="RedisæŒä¹…åŒ–æœºåˆ¶"><!---->RedisæŒä¹…åŒ–æœºåˆ¶<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#æŒä¹…åŒ–åˆ†ç±»" class="router-link-active router-link-exact-active nav-link vp-sidebar-link vp-heading" aria-label="æŒä¹…åŒ–åˆ†ç±»"><!---->æŒä¹…åŒ–åˆ†ç±»<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#rdb-æŒä¹…åŒ–" class="router-link-active router-link-exact-active nav-link vp-sidebar-link vp-heading" aria-label="RDB æŒä¹…åŒ–"><!---->RDB æŒä¹…åŒ–<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#rdb-æŒä¹…åŒ–-1" class="router-link-active router-link-exact-active nav-link vp-sidebar-link vp-heading" aria-label="RDB æŒä¹…åŒ–"><!---->RDB æŒä¹…åŒ–<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#save-å‘½ä»¤é˜»å¡æœåŠ¡å™¨åˆ›å»º-rdb-æ–‡ä»¶" class="router-link-active router-link-exact-active nav-link vp-sidebar-link vp-heading" aria-label="SAVE å‘½ä»¤é˜»å¡æœåŠ¡å™¨åˆ›å»º RDB æ–‡ä»¶"><!---->SAVE å‘½ä»¤é˜»å¡æœåŠ¡å™¨åˆ›å»º RDB æ–‡ä»¶<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#bgsave-ä»¥éé˜»å¡æ–¹å¼åˆ›å»º-rdb-æ–‡ä»¶" class="router-link-active router-link-exact-active nav-link vp-sidebar-link vp-heading" aria-label="BGSAVE ä»¥éé˜»å¡æ–¹å¼åˆ›å»º RDB æ–‡ä»¶"><!---->BGSAVE ä»¥éé˜»å¡æ–¹å¼åˆ›å»º RDB æ–‡ä»¶<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#é€šè¿‡é…ç½®è‡ªåŠ¨åˆ›å»º-rdb-æ–‡ä»¶" class="router-link-active router-link-exact-active nav-link vp-sidebar-link vp-heading" aria-label="é€šè¿‡é…ç½®è‡ªåŠ¨åˆ›å»º RDB æ–‡ä»¶"><!---->é€šè¿‡é…ç½®è‡ªåŠ¨åˆ›å»º RDB æ–‡ä»¶<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#rdb-æŒä¹…åŒ–çš„åŸç†" class="router-link-active router-link-exact-active nav-link vp-sidebar-link vp-heading" aria-label="RDB æŒä¹…åŒ–çš„åŸç†"><!---->RDB æŒä¹…åŒ–çš„åŸç†<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#rdb-æ–‡ä»¶ç»“æ„-æœ¬èŠ‚åŸºäº-redis-5" class="router-link-active router-link-exact-active nav-link vp-sidebar-link vp-heading" aria-label="RDB æ–‡ä»¶ç»“æ„ - æœ¬èŠ‚åŸºäº Redis 5"><!---->RDB æ–‡ä»¶ç»“æ„ - æœ¬èŠ‚åŸºäº Redis 5<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#åŠ è½½-rdb-æ–‡ä»¶" class="router-link-active router-link-exact-active nav-link vp-sidebar-link vp-heading" aria-label="åŠ è½½ RDB æ–‡ä»¶"><!---->åŠ è½½ RDB æ–‡ä»¶<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#rdb-ä¼˜ç¼ºç‚¹" class="router-link-active router-link-exact-active nav-link vp-sidebar-link vp-heading" aria-label="RDB ä¼˜ç¼ºç‚¹"><!---->RDB ä¼˜ç¼ºç‚¹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#aof-æŒä¹…åŒ–" class="router-link-active router-link-exact-active nav-link vp-sidebar-link vp-heading" aria-label="AOF æŒä¹…åŒ–"><!---->AOF æŒä¹…åŒ–<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#aof-å·¥ä½œæµç¨‹" class="router-link-active router-link-exact-active nav-link vp-sidebar-link vp-heading" aria-label="AOF å·¥ä½œæµç¨‹"><!---->AOF å·¥ä½œæµç¨‹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#aof-æ–‡ä»¶åˆ·æ–°é¢‘ç‡" class="router-link-active router-link-exact-active nav-link vp-sidebar-link vp-heading" aria-label="AOF æ–‡ä»¶åˆ·æ–°é¢‘ç‡"><!---->AOF æ–‡ä»¶åˆ·æ–°é¢‘ç‡<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#aof-é‡å†™" class="router-link-active router-link-exact-active nav-link vp-sidebar-link vp-heading" aria-label="AOF é‡å†™"><!---->AOF é‡å†™<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#æ–‡ä»¶æ ¡éªŒ" class="router-link-active router-link-exact-active nav-link vp-sidebar-link vp-heading" aria-label="æ–‡ä»¶æ ¡éªŒ"><!---->æ–‡ä»¶æ ¡éªŒ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#aof-çš„ä¼˜ç¼ºç‚¹" class="router-link-active router-link-exact-active nav-link vp-sidebar-link vp-heading" aria-label="AOF çš„ä¼˜ç¼ºç‚¹"><!---->AOF çš„ä¼˜ç¼ºç‚¹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#rdb-aof-æ··åˆæŒä¹…åŒ–" class="router-link-active router-link-exact-active nav-link vp-sidebar-link vp-heading" aria-label="RDB-AOF æ··åˆæŒä¹…åŒ–"><!---->RDB-AOF æ··åˆæŒä¹…åŒ–<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#åŒæ—¶ä½¿ç”¨-rdb-æŒä¹…åŒ–å’Œ-aof-æŒä¹…åŒ–" class="router-link-active router-link-exact-active nav-link vp-sidebar-link vp-heading" aria-label="åŒæ—¶ä½¿ç”¨ RDB æŒä¹…åŒ–å’Œ AOF æŒä¹…åŒ–"><!---->åŒæ—¶ä½¿ç”¨ RDB æŒä¹…åŒ–å’Œ AOF æŒä¹…åŒ–<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#shutdown-å…³é—­æœåŠ¡å™¨" class="router-link-active router-link-exact-active nav-link vp-sidebar-link vp-heading" aria-label="SHUTDOWN å…³é—­æœåŠ¡å™¨"><!---->SHUTDOWN å…³é—­æœåŠ¡å™¨<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#æŒä¹…åŒ–ç›¸å…³çš„é…ç½®é¡¹" class="router-link-active router-link-exact-active nav-link vp-sidebar-link vp-heading" aria-label="æŒä¹…åŒ–ç›¸å…³çš„é…ç½®é¡¹"><!---->æŒä¹…åŒ–ç›¸å…³çš„é…ç½®é¡¹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/Redis/Redis%E9%94%AE%E7%A9%BA%E9%97%B4%E9%80%9A%E7%9F%A5(keyspace%20notification).html" class="nav-link vp-sidebar-link vp-sidebar-page" aria-label="Redisé”®ç©ºé—´é€šçŸ¥"><!---->Redisé”®ç©ºé—´é€šçŸ¥<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->RedisæŒä¹…åŒ–æœºåˆ¶</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">è¶…å¨è“çŒ« Dylan Kwok</span></span><span property="author" content="è¶…å¨è“çŒ« Dylan Kwok"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-05-07T11:11:01.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 29 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT29M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#æŒä¹…åŒ–åˆ†ç±»" class="router-link-active router-link-exact-active toc-link level2">æŒä¹…åŒ–åˆ†ç±»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#rdb-æŒä¹…åŒ–" class="router-link-active router-link-exact-active toc-link level2">RDB æŒä¹…åŒ–</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#rdb-æŒä¹…åŒ–-1" class="router-link-active router-link-exact-active toc-link level3">RDB æŒä¹…åŒ–</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#save-å‘½ä»¤é˜»å¡æœåŠ¡å™¨åˆ›å»º-rdb-æ–‡ä»¶" class="router-link-active router-link-exact-active toc-link level3">SAVE å‘½ä»¤é˜»å¡æœåŠ¡å™¨åˆ›å»º RDB æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#bgsave-ä»¥éé˜»å¡æ–¹å¼åˆ›å»º-rdb-æ–‡ä»¶" class="router-link-active router-link-exact-active toc-link level3">BGSAVE ä»¥éé˜»å¡æ–¹å¼åˆ›å»º RDB æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#é€šè¿‡é…ç½®è‡ªåŠ¨åˆ›å»º-rdb-æ–‡ä»¶" class="router-link-active router-link-exact-active toc-link level3">é€šè¿‡é…ç½®è‡ªåŠ¨åˆ›å»º RDB æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#rdb-æŒä¹…åŒ–çš„åŸç†" class="router-link-active router-link-exact-active toc-link level3">RDB æŒä¹…åŒ–çš„åŸç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#rdb-æ–‡ä»¶ç»“æ„-æœ¬èŠ‚åŸºäº-redis-5" class="router-link-active router-link-exact-active toc-link level3">RDB æ–‡ä»¶ç»“æ„ - æœ¬èŠ‚åŸºäº Redis 5</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#åŠ è½½-rdb-æ–‡ä»¶" class="router-link-active router-link-exact-active toc-link level3">åŠ è½½ RDB æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#rdb-ä¼˜ç¼ºç‚¹" class="router-link-active router-link-exact-active toc-link level3">RDB ä¼˜ç¼ºç‚¹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#aof-æŒä¹…åŒ–" class="router-link-active router-link-exact-active toc-link level2">AOF æŒä¹…åŒ–</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#aof-å·¥ä½œæµç¨‹" class="router-link-active router-link-exact-active toc-link level3">AOF å·¥ä½œæµç¨‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#aof-æ–‡ä»¶åˆ·æ–°é¢‘ç‡" class="router-link-active router-link-exact-active toc-link level3">AOF æ–‡ä»¶åˆ·æ–°é¢‘ç‡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#aof-é‡å†™" class="router-link-active router-link-exact-active toc-link level3">AOF é‡å†™</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#æ–‡ä»¶æ ¡éªŒ" class="router-link-active router-link-exact-active toc-link level3">æ–‡ä»¶æ ¡éªŒ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#aof-çš„ä¼˜ç¼ºç‚¹" class="router-link-active router-link-exact-active toc-link level3">AOF çš„ä¼˜ç¼ºç‚¹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#rdb-aof-æ··åˆæŒä¹…åŒ–" class="router-link-active router-link-exact-active toc-link level2">RDB-AOF æ··åˆæŒä¹…åŒ–</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#åŒæ—¶ä½¿ç”¨-rdb-æŒä¹…åŒ–å’Œ-aof-æŒä¹…åŒ–" class="router-link-active router-link-exact-active toc-link level2">åŒæ—¶ä½¿ç”¨ RDB æŒä¹…åŒ–å’Œ AOF æŒä¹…åŒ–</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#shutdown-å…³é—­æœåŠ¡å™¨" class="router-link-active router-link-exact-active toc-link level2">SHUTDOWN å…³é—­æœåŠ¡å™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6.html#æŒä¹…åŒ–ç›¸å…³çš„é…ç½®é¡¹" class="router-link-active router-link-exact-active toc-link level2">æŒä¹…åŒ–ç›¸å…³çš„é…ç½®é¡¹</a></li><!----><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><table><thead><tr><th>ç‰ˆæœ¬</th><th>å†…å®¹</th><th>æ—¶é—´</th></tr></thead><tbody><tr><td>V1</td><td>æ–°å»º</td><td>2023å¹´03æœˆ30æ—¥01:25:08</td></tr></tbody></table><p>æœ¬æ–‡å†…å®¹æ¥è‡ªï¼š</p><ol><li>https://redis.io/docs/management/persistence/</li><li>ã€ŠRedis ä½¿ç”¨æ‰‹å†Œã€‹ -- å¯ä»¥</li><li>ã€ŠRedis å¼€å‘å’Œè¿ç»´ã€‹-- å¾ˆæ£’</li><li>ã€ŠRedis æ·±åº¦å†é™©ã€‹ -- å»ºè®®ä¸çœ‹è¿™ä¸ª</li><li>ã€ŠRedis 5 è®¾è®¡å’Œæºç åˆ†æã€‹-- å¯ä»¥</li></ol><h2 id="æŒä¹…åŒ–åˆ†ç±»" tabindex="-1"><a class="header-anchor" href="#æŒä¹…åŒ–åˆ†ç±»" aria-hidden="true">#</a> æŒä¹…åŒ–åˆ†ç±»</h2><p>Redis çš„æ•°æ®éƒ½å­˜åœ¨å†…å­˜é‡Œé¢ï¼Œå¦‚æœçªç„¶å®•æœºï¼Œæ•°æ®å°±ä¼šå…¨éƒ¨ä¸¢å¤±ï¼Œåœ¨éœ€è¦çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å°†æ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜ä¸­ã€‚ä¸‹é¢æ˜¯æŒä¹…åŒ–æœºåˆ¶çš„åˆ†ç±»ï¼š</p><ul><li><strong>RDB</strong> (Redis Database): RDB persistence performs point-in-time snapshots of your dataset at specified intervals.</li><li><strong>AOF</strong> (Append Only File): AOF persistence logs every write operation received by the server. These operations can then be replayed again at server startup, reconstructing the original dataset. Commands are logged using the same format as the Redis protocol itself.</li><li><strong>No persistence</strong>: You can disable persistence completely. This is sometimes used when caching.</li><li><strong>RDB + AOF</strong>: You can also combine both AOF and RDB in the same instance.</li></ul><p>ç®€å•æ¥è¯´ï¼ŒRDB æ˜¯ä¸€ç§å¿«ç…§æ¨¡å¼ï¼Œæ¯æ¬¡å…¨é‡å¤‡ä»½ï¼Œå¿«ç…§æ˜¯å†…å­˜æ•°æ®çš„äºŒè¿›åˆ¶åºåˆ—åŒ–å½¢å¼ï¼Œå­˜å‚¨ç´§å‡‘ã€‚è€Œ AOF æ—¥å¿—æ˜¯è¿ç»­çš„å¢é‡å¤‡ä»½ï¼Œè®°å½•çš„æ˜¯å†…å­˜æ•°æ®ä¿®æ”¹çš„æŒ‡ä»¤è®°å½•æ–‡æœ¬ã€‚</p><h2 id="rdb-æŒä¹…åŒ–" tabindex="-1"><a class="header-anchor" href="#rdb-æŒä¹…åŒ–" aria-hidden="true">#</a> RDB æŒä¹…åŒ–</h2><h3 id="rdb-æŒä¹…åŒ–-1" tabindex="-1"><a class="header-anchor" href="#rdb-æŒä¹…åŒ–-1" aria-hidden="true">#</a> RDB æŒä¹…åŒ–</h3><p>RDB æŒä¹…åŒ–äº§ç”Ÿçš„æ–‡ä»¶æ˜¯ä»¥ .rdb åç¼€ç»“å°¾ï¼Œå…¶ä¸­ rdb è¡¨ç¤º Redis Databaseã€‚</p><p>Redis æœ‰å¤šç§æ–¹å¼åˆ›å»º RDB æ–‡ä»¶ï¼š</p><ul><li>SAVE å‘½ä»¤ï¼›</li><li>BGSAVE å‘½ä»¤ï¼›</li><li>é…ç½®æ–‡ä»¶é…ç½®è§¦å‘åˆ›å»º RDB æ–‡ä»¶çš„æ¡ä»¶ï¼›</li></ul><h3 id="save-å‘½ä»¤é˜»å¡æœåŠ¡å™¨åˆ›å»º-rdb-æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#save-å‘½ä»¤é˜»å¡æœåŠ¡å™¨åˆ›å»º-rdb-æ–‡ä»¶" aria-hidden="true">#</a> SAVE å‘½ä»¤é˜»å¡æœåŠ¡å™¨åˆ›å»º RDB æ–‡ä»¶</h3><blockquote><p>https://redis.io/commands/save/</p></blockquote><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Available since:1.0.0
Time complexity:O(N) where N is the total number of keys in all databases
ACL categories:@admin, @slow, @dangerous
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>SAVE å‘½ä»¤ä¼šé˜»å¡ Redis æœåŠ¡å™¨è¿›ç¨‹ï¼Œç›´åˆ° RDB æ–‡ä»¶åˆ›å»ºå®Œæ¯•ä¸ºæ­¢ï¼Œåœ¨æœåŠ¡å™¨è¿›ç¨‹é˜»å¡æœŸé—´ï¼ŒæœåŠ¡å™¨ä¸èƒ½å¤„ç†ä»»ä½•å‘½ä»¤è¯·æ±‚ã€‚å¯¹äºå†…å­˜æ¯”è¾ƒå¤§çš„å®ä¾‹ä¼šé€ æˆé•¿æ—¶é—´é˜»å¡ï¼Œçº¿ä¸Šç¯å¢ƒä¸å»ºè®®ä½¿ç”¨ã€‚</p><p>å½“æ¥æ”¶åˆ° SAVE å‘½ä»¤çš„ Redis æœåŠ¡å™¨ä¼šéå†æ•°æ®åº“åŒ…å«çš„æ‰€æœ‰æ•°æ®åº“ï¼Œå°†å„ä¸ªæ•°æ®åº“åŒ…å«çš„é”®å€¼å¯¹å…¨éƒ¨è®°å½•åˆ° RDB æ–‡ä»¶ä¸­ã€‚å‡å¦‚ä¹‹å‰å·²ç»å­˜åœ¨ RDB æ–‡ä»¶ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°†ä½¿ç”¨æ–°åˆ›å»ºçš„ RDB æ–‡ä»¶æ›¿ä»£å·²æœ‰çš„ RDB æ–‡ä»¶ã€‚</p><h3 id="bgsave-ä»¥éé˜»å¡æ–¹å¼åˆ›å»º-rdb-æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#bgsave-ä»¥éé˜»å¡æ–¹å¼åˆ›å»º-rdb-æ–‡ä»¶" aria-hidden="true">#</a> BGSAVE ä»¥éé˜»å¡æ–¹å¼åˆ›å»º RDB æ–‡ä»¶</h3><blockquote><p>https://redis.io/commands/bgsave/</p></blockquote><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Available since:1.0.0
Time complexity:O(1)
ACL categories:@admin, @slow, @dangerous
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>BGSAVE ä¸ä¼šç›´æ¥ä½¿ç”¨ Redis æœåŠ¡å™¨è¿›ç¨‹åˆ›å»º RDB æ–‡ä»¶ï¼Œè€Œæ˜¯ä½¿ç”¨å­è¿›ç¨‹åˆ›å»º RDB æ–‡ä»¶ã€‚</p><p>Redis 3.0 çš„æµç¨‹</p><img src="/assets/bgsaveå‘½ä»¤æµç¨‹-d6a675ba.png" alt="bgsaveå‘½ä»¤æµç¨‹" style="zoom:50%;"><ul><li>æ‰§è¡Œ BGSAVE å‘½ä»¤ï¼ŒRedis çˆ¶è¿›ç¨‹åˆ¤æ–­å½“å‰æ˜¯å¦å­˜åœ¨æ­£åœ¨æ‰§è¡Œçš„å­è¿›ç¨‹ï¼Œå¦‚ RDBã€AOF å­è¿›ç¨‹ï¼Œå¦‚æœå­˜åœ¨ BGSAVE å‘½ä»¤ç›´æ¥è¿”å›ï¼›</li><li>çˆ¶è¿›ç¨‹æ‰§è¡Œ fork æ“ä½œåˆ›å»ºå­è¿›ç¨‹ï¼Œfork æ“ä½œè¿‡ç¨‹ä¸­çˆ¶è¿›ç¨‹ä¼šé˜»å¡ï¼Œé€šè¿‡ info stats å‘½ä»¤æŸ¥çœ‹ lastest_fork_usecï¼Œå¯ä»¥æŸ¥çœ‹æœ€è¿‘ä¸€ä¸ª fork æ“ä½œçš„è€—æ—¶ï¼ˆå¾®ç§’ï¼‰ï¼›</li><li>çˆ¶è¿›ç¨‹ fork å®Œæˆåï¼ŒBGSAVE å‘½ä»¤è¿”å› â€œBackground saving startedâ€ä¿¡æ¯ï¼Œå¹¶ä¸å†é˜»å¡çˆ¶è¿›ç¨‹ï¼Œçˆ¶è¿›ç¨‹å¯ä»¥ç»§ç»­å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼›</li><li>å­è¿›ç¨‹åˆ›å»ºä¸´æ—¶çš„ RDB æ–‡ä»¶ï¼Œæ ¹æ®çˆ¶è¿›ç¨‹å†…å­˜ç”Ÿæˆä¸´æ—¶å¿«ç…§æ–‡ä»¶ï¼Œå®Œæˆåå¯¹åŸæœ‰æ–‡ä»¶è¿›è¡ŒåŸå­æ›¿æ¢ã€‚æ‰§è¡Œ LASTSAVE å‘½ä»¤å¯ä»¥è·å–æœ€åä¸€æ¬¡ç”Ÿæˆ RDB æ–‡ä»¶çš„æ—¶é—´ï¼›</li><li>å­è¿›ç¨‹å‘é€ä¿¡å·ç»™çˆ¶è¿›ç¨‹è¡¨ç¤ºåˆ›å»º RDB æ–‡ä»¶å®Œæˆï¼Œä½¿ç”¨æ–°çš„ RDB æ–‡ä»¶æ›¿æ¢å·²æœ‰çš„ RDB æ–‡ä»¶ã€‚æ›´æ–°ç»Ÿè®¡ä¿¡æ¯ï¼Œå…·ä½“å¯ä»¥é€šè¿‡ info persistence æŸ¥çœ‹ï¼›</li></ul><p>è™½ç„¶ BGSAVE å‘½ä»¤ä¸ä¼šåƒ SAVE å‘½ä»¤é‚£æ ·ä¸€ç›´é˜»å¡æœåŠ¡å™¨ï¼Œä½†æ˜¯å› ä¸º BGSAVE æ˜¯ fork ä¸€ä¸ªå­è¿›ç¨‹æ¥åˆ›å»º RDB çš„ï¼Œæ‰€ä»¥å½“çˆ¶è¿›ç¨‹å ç”¨çš„å†…å­˜æ•°é‡è¶Šå¤§ï¼Œåˆ›å»ºå­è¿›ç¨‹è¿™ä¸€æ“ä½œè€—è´¹çš„æ—¶é—´ä¹Ÿä¼šè¶Šé•¿ï¼Œæ‰€ä»¥ Redis æœåŠ¡å™¨åœ¨æ‰§è¡Œ BGSAVE å‘½ä»¤çš„æ—¶å€™ä¹Ÿå¯èƒ½ä¼šå› ä¸º fork å­è¿›ç¨‹è€ŒçŸ­æš‚é˜»å¡ã€‚</p><blockquote><p>å½“é‡åˆ°åç›˜æˆ–ç£ç›˜å†™æ»¡çš„æƒ…å†µæ—¶ï¼Œå¯ä»¥é€šè¿‡ config set dir åœ¨çº¿ä¿®æ”¹æ–‡ä»¶è·¯å¾„åˆ°å¯ç”¨çš„ç£ç›˜è·¯å¾„ã€‚</p></blockquote><h3 id="é€šè¿‡é…ç½®è‡ªåŠ¨åˆ›å»º-rdb-æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#é€šè¿‡é…ç½®è‡ªåŠ¨åˆ›å»º-rdb-æ–‡ä»¶" aria-hidden="true">#</a> é€šè¿‡é…ç½®è‡ªåŠ¨åˆ›å»º RDB æ–‡ä»¶</h3><p>é…ç½®æ–‡ä»¶å†…çš„é…ç½®é¡¹</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>save &lt;seconds&gt; &lt;changes&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>secondsï¼šæŒ‡å®šè§¦å‘æŒä¹…åŒ–æ“ä½œæ‰€éœ€çš„æ—¶é•¿ï¼›</li><li>changesï¼šæŒ‡å®šè§¦å‘æŒä¹…åŒ–æ“ä½œæ‰€éœ€çš„ä¿®æ”¹æ¬¡æ•°ï¼›</li></ul><p>å°±æ˜¯è¯´å¦‚æœæœåŠ¡å™¨åœ¨ seconds ç§’çš„æ—¶é—´å†…ï¼Œå¯¹å„ä¸ªæ•°æ®åº“æ€»å…±æ‰§è¡Œäº†è‡³å°‘ changes æ¬¡ä¿®æ”¹ï¼ŒæœåŠ¡å™¨å°±ä¼šè‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡ BGSAVEã€‚</p><p>Redis 5 çš„é…ç½®æ–‡ä»¶ä¸­é»˜è®¤çš„é…ç½®ï¼Œåªè¦ä¸‹é¢ä»»æ„ä¸€ä¸ªæ¡ä»¶æ»¡è¶³æ—¶ï¼Œå°±ä¼šè§¦å‘ä¸€æ¬¡ BGSAVEã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>save 900 1
save 300 10
save 60 10000
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>æ³¨æ„ï¼šä¸ºäº†é¿å…ç”±äºåŒæ—¶ä½¿ç”¨å¤šä¸ªè§¦å‘æ¡ä»¶å¯¼è‡´æœåŠ¡å™¨è¿‡äºé¢‘ç¹çš„æ‰§è¡Œ BGSAVEï¼ŒæœåŠ¡å™¨æ¯æ¬¡æˆåŠŸåˆ›å»º RDB æ–‡ä»¶ä¹‹åï¼Œè´Ÿè´£è‡ªåŠ¨è§¦å‘ BGSAVE å‘½ä»¤çš„æ—¶é—´è®¡æ•°å™¨ä»¥åŠä¿®æ”¹æ¬¡æ•°è®¡æ•°å™¨éƒ½ä¼šè¢«æ¸…é›¶ï¼Œé‡æ–°å¼€å§‹è®¡ç®—ã€‚</p></blockquote><h3 id="rdb-æŒä¹…åŒ–çš„åŸç†" tabindex="-1"><a class="header-anchor" href="#rdb-æŒä¹…åŒ–çš„åŸç†" aria-hidden="true">#</a> RDB æŒä¹…åŒ–çš„åŸç†</h3><p>ä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨ BGSAVE æ¥å®ŒæˆæŒä¹…åŒ–æ“ä½œçš„ã€‚Redis ä¼šè°ƒç”¨ glibc çš„ fork å‡½æ•°äº§ç”Ÿä¸€ä¸ªå­è¿›ç¨‹ï¼ŒRDB æŒä¹…åŒ–ç”±è¿™ä¸ªå­è¿›ç¨‹æ¥å¤„ç†ï¼Œçˆ¶è¿›ç¨‹ç»§ç»­å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚å­è¿›ç¨‹åˆšåˆšäº§ç”Ÿæ—¶ï¼Œå®ƒå’Œçˆ¶è¿›ç¨‹å…±äº«å†…å­˜é‡Œé¢çš„ä»£ç æ®µå’Œæ•°æ®æ®µã€‚</p><p>Redis éœ€è¦ä¸€è¾¹æŒä¹…åŒ–ï¼Œä¸€è¾¹å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚æŒä¹…åŒ–æ“ä½œçš„åŒæ—¶ï¼Œå†…å­˜çš„æ•°æ®ç»“æ„è¿˜åœ¨æ”¹å˜ã€‚è¿™æ—¶å€™éœ€è¦ä½¿ç”¨ COWï¼ˆCopy on Writeï¼‰æœºåˆ¶æ¥å®ç° RDB çš„æŒä¹…åŒ–ã€‚</p><p>æ•°æ®æ®µæ˜¯ä¸€ä¸ªç”±å¤šä¸ªæ“ä½œç³»ç»Ÿçš„é¡µé¢ï¼ˆ4KBï¼‰ç»„æˆçš„ï¼Œå½“çˆ¶è¿›ç¨‹å¯¹å…¶ä¸­çš„ä¸€ä¸ªé¡µé¢çš„æ•°æ®è¿›è¡Œä¿®æ”¹æ—¶ï¼Œä¼šå°†è¢«å…±äº«çš„é¡µé¢å¤åˆ¶ä¸€ä»½åˆ†ç¦»å‡ºæ¥ï¼Œç„¶åå¯¹è¿™ä¸ªå¤åˆ¶çš„é¡µé¢è¿›è¡Œä¿®æ”¹ã€‚è¿™æ—¶å­è¿›ç¨‹ç›¸åº”çš„é¡µé¢æ˜¯æ²¡æœ‰å˜åŒ–çš„ï¼Œè¿˜æ˜¯è¿›ç¨‹äº§ç”Ÿæ—¶çš„é‚£ä¸€ç¬é—´çš„æ•°æ®ã€‚</p><p>éšç€çˆ¶è¿›ç¨‹ä¿®æ”¹æ“ä½œçš„æŒç»­è¿›è¡Œï¼Œè¶Šæ¥è¶Šå¤šçš„å…±äº«é¡µé¢è¢«åˆ†ç¦»å‡ºæ¥ï¼Œå†…å­˜å°±ä¼šæŒç»­å¢é•¿ï¼Œä½†æ˜¯ä¹Ÿä¸ä¼šè¶…è¿‡åŸæœ‰æ•°æ®å†…å­˜çš„ 2 å€ã€‚å¦å¤– Redis å®ä¾‹é‡Œé¢çš„å†·æ•°æ®çš„æ¯”ä¾‹æ¯”ä¾‹ä¹Ÿæ˜¯å¾ˆé«˜çš„ï¼Œæ‰€ä»¥å¾ˆå°‘ä¼šå‡ºç°æ‰€æœ‰é¡µé¢éƒ½è¢«åˆ†ç¦»çš„æƒ…å†µã€‚</p><h3 id="rdb-æ–‡ä»¶ç»“æ„-æœ¬èŠ‚åŸºäº-redis-5" tabindex="-1"><a class="header-anchor" href="#rdb-æ–‡ä»¶ç»“æ„-æœ¬èŠ‚åŸºäº-redis-5" aria-hidden="true">#</a> RDB æ–‡ä»¶ç»“æ„ - æœ¬èŠ‚åŸºäº Redis 5</h3><h4 id="rdb-æ–‡ä»¶çš„æ€»ä½“ç»“æ„" tabindex="-1"><a class="header-anchor" href="#rdb-æ–‡ä»¶çš„æ€»ä½“ç»“æ„" aria-hidden="true">#</a> RDB æ–‡ä»¶çš„æ€»ä½“ç»“æ„</h4><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>+-------------------------------------------------------------------------------+
| RDBæ–‡ä»¶æ ‡è¯†ç¬¦ | ç‰ˆæœ¬å· | è®¾å¤‡é™„åŠ ä¿¡æ¯ | æ•°æ®åº“æ•°æ® | Lua è„šæœ¬ç¼“å­˜ | EOF | CRC64 æ ¡éªŒå’Œ |
+-------------------------------------------------------------------------------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="/assets/RDBæ•´ä½“æ–‡ä»¶ç»“æ„-e2304233.png" alt="RDBæ•´ä½“æ–‡ä»¶ç»“æ„" style="zoom:67%;"><ul><li><p><strong>RDB æ–‡ä»¶æ ‡è¯†ç¬¦</strong></p><p>å°±æ˜¯ â€œREDISâ€ è¿™ 5 ä¸ªå­—ç¬¦ã€‚Redis åœ¨åŠ è½½çš„æ—¶å€™é€šè¿‡è¿™ä¸ªæ ‡è¯†ç¬¦åˆ¤æ–­å½“å‰æ–‡ä»¶æ˜¯å¦æ˜¯ RDB æ–‡ä»¶ï¼›</p></li><li><p><strong>RDB ç‰ˆæœ¬å·</strong></p><p>4 ä¸ªå­—èŠ‚ï¼Œæ˜¯ RDB çš„ç‰ˆæœ¬å·ï¼Œä¸æ˜¯ Redis çš„ç‰ˆæœ¬å·ã€‚å‡å¦‚ RDB ç‰ˆæœ¬æ˜¯ç¬¬ 9 ç‰ˆï¼Œé‚£ä¹ˆè¿™ä¸ªä½ç½®å°±æ˜¯â€œ0009â€ã€‚</p><p>æ–°ç‰ˆçš„ Redis æœåŠ¡å™¨æ˜¯èƒ½å¤Ÿå‘ä¸‹å…¼å®¹æ—§ç‰ˆçš„ Redis æœåŠ¡å™¨ç”Ÿæˆçš„ RDB æ–‡ä»¶çš„ï¼›</p></li><li><p><strong>è®¾å¤‡é™„åŠ ä¿¡æ¯</strong></p><p>RDB æ–‡ä»¶çš„è®¾å¤‡é™„åŠ ä¿¡æ¯è®°å½•äº†ç”Ÿæˆ RDB æ–‡ä»¶çš„ Redis æœåŠ¡å™¨åŠå…¶æ‰€åœ¨å¹³å°çš„ä¿¡æ¯ï¼Œä¾‹å¦‚æœåŠ¡å™¨çš„ç‰ˆæœ¬å·ï¼Œå®¿ä¸»æœºçš„æ¶æ„ã€åˆ›å»º RDB æ–‡ä»¶æ—¶çš„æ—¶é—´æˆ³ã€æœåŠ¡å™¨å ç”¨çš„å†…å­˜æ•°é‡ç­‰ï¼›</p></li><li><p><strong>æ•°æ®åº“æ•°æ®</strong></p><p>æ•°æ®åº“æ•°æ®éƒ¨åˆ†è®°å½•äº† Redis æœåŠ¡å™¨å­˜å‚¨çš„ 0 ä¸ªæˆ–è€…ä»»æ„å¤šä¸ªæ•°æ®åº“çš„æ•°æ®ï¼Œå½“è¿™ä¸ªéƒ¨åˆ†åŒ…å«çš„å¤šä¸ªæ•°æ®åº“çš„æ•°æ®æ—¶ï¼Œå„ä¸ªæ•°æ®åº“å°†æŒ‰ç…§æ•°æ®åº“å·ç å¤§å°ä»å°åˆ°å¤§è¿›è¡Œæ’åˆ—ï¼›</p></li><li><p><strong>Lua è„šæœ¬ç¼“å­˜</strong></p><p>å¦‚æœ Redis æœåŠ¡å™¨å¯ç”¨äº†å¤åˆ¶åŠŸèƒ½ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°†åœ¨ RDB æ–‡ä»¶ä¼šåœ¨è¿™é‡Œä¿å­˜æ‰€æœ‰å·²è¢«ç¼“å­˜çš„ Lua è„šæœ¬ã€‚è¿™æ ·ï¼Œä»æœåŠ¡å™¨åœ¨è½½å…¥ RDB æ–‡ä»¶å®Œæˆæ•°æ®åŒæ­¥ä¹‹åï¼Œå°±å¯ä»¥ç»§ç»­æ‰§è¡Œä¸»æœåŠ¡å™¨å‘è¿‡æ¥çš„ EVALSHA å‘½ä»¤äº†ï¼›</p></li><li><p><strong>EOF</strong></p><p>æ ‡è®° RDB æ­£æ–‡å†…å®¹ç»“å°¾ï¼Œå®é™…å€¼â€œ0xFFâ€ï¼›</p></li><li><p><strong>CRC64 æ ¡éªŒå’Œ</strong></p><p>RDB æ–‡ä»¶æœ«å°¾æ˜¯ä¸€ä¸ªä»¥æ— ç¬¦å· 64 ä½æ•´æ•°è¡¨ç¤º CRC64 æ ¡éªŒå’Œã€‚Redis æœåŠ¡å™¨åœ¨è¯»å…¥ RDB æ–‡ä»¶æ—¶ä¼šé€šè¿‡è¿™ä¸ªæ ¡éªŒå’Œæ¥å¿«é€Ÿçš„æ£€æŸ¥ RDB æ–‡ä»¶æ˜¯å¦æœ‰å‡ºé”™æˆ–è€…æŸåçš„æƒ…å†µå‡ºç°ï¼›</p></li></ul><h4 id="æ•°æ®åº“æ•°æ®éƒ¨åˆ†" tabindex="-1"><a class="header-anchor" href="#æ•°æ®åº“æ•°æ®éƒ¨åˆ†" aria-hidden="true">#</a> æ•°æ®åº“æ•°æ®éƒ¨åˆ†</h4><p>å‰é¢è¯´è¿‡ RDB æ•°æ®åº“éƒ¨åˆ†åŒ…å«äº†ä»»æ„å¤šä¸ªæ•°æ®åº“çš„æ•°æ®ï¼Œå…¶ä¸­æ¯ä¸ªæ•°æ®åº“çš„ç”±ä¸‹é¢è¿™ä¸ªç»„æˆ</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>+-------------------------------------------------------------+
| æ•°æ®åº“ç¼–å· | é”®å€¼å¯¹æ€»æ•°é‡ | å¸¦æœ‰è¿‡æœŸæ—¶é—´çš„é”®å€¼å¯¹æ•°é‡ | é”®å€¼å¯¹æ•°æ®éƒ¨åˆ† |
+-------------------------------------------------------------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Redis åœ¨è¯»å– RDB æ–‡ä»¶çš„æ•°æ®æ—¶ï¼Œä¼šæ ¹æ®ã€Œæ•°æ®åº“ç¼–å·ã€æ¥åˆ‡æ¢åˆ°å¯¹åº”çš„æ•°æ®åº“ï¼›</li><li>Redis æ ¹æ®ã€Œé”®å€¼å¯¹æ€»æ•°é‡ã€å’Œã€Œå¸¦æœ‰è¿‡æœŸæ—¶é—´çš„é”®å€¼å¯¹æ•°é‡ã€å°½å¯èƒ½é€šè¿‡æœ€ä¼˜çš„æ–¹å¼åˆ›å»ºæ•°æ®åº“çš„å†…éƒ¨æ•°æ®ç»“æ„ï¼› <ul><li>Redisçš„æ¯ä¸ªæ•°æ®åº“æ˜¯ä¸€ä¸ªæ•£åˆ—è¡¨ï¼Œè¿™ä¸ªå­—æ®µæŒ‡æ˜å½“å‰æ•°æ®åº“æ•£åˆ—è¡¨çš„å¤§å°ã€‚è¿™æ ·åœ¨åŠ è½½æ—¶å¯ä»¥ç›´æ¥å°†æ•£åˆ—è¡¨æ‰©å±•åˆ°æŒ‡å®šå¤§å°ï¼Œæå‡åŠ è½½é€Ÿåº¦ï¼›</li><li>Redisçš„è¿‡æœŸæ—¶é—´ä¹Ÿæ˜¯ä¿å­˜ä¸ºä¸€ä¸ªæ•£åˆ—è¡¨ï¼Œè¯¥å­—æ®µæŒ‡æ˜å½“å‰æ•°æ®åº“è¿‡æœŸæ—¶é—´æ•£åˆ—è¡¨çš„å¤§å°ï¼›</li></ul></li><li>æœ€å RDB ä»¥æ— åºæ–¹å¼è®°å½•æ•°æ®åº“åŒ…å«çš„æ‰€æœ‰é”®å€¼å¯¹ï¼›</li></ul><h4 id="é”®å€¼å¯¹éƒ¨åˆ†" tabindex="-1"><a class="header-anchor" href="#é”®å€¼å¯¹éƒ¨åˆ†" aria-hidden="true">#</a> é”®å€¼å¯¹éƒ¨åˆ†</h4><p>æ¯ä¸ªé”®å€¼å¯¹æœ€å¤šä¼šè¢«åˆ’åˆ†ä¸º 5 ä¸ªéƒ¨åˆ†</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>+-----------------------------------------------------------------+
| è¿‡æœŸæ—¶é—´ï¼ˆå¯é€‰ï¼‰ | LRU ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰æˆ– LFU ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰ | ç±»å‹ | é”® | å€¼ |
+-----------------------------------------------------------------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿‡æœŸæ—¶é—´å¯é€‰ï¼Œæ ¹æ®å…·ä½“çš„é”®æ˜¯å¦æœ‰è¿‡æœŸæ—¶é—´ï¼›</li><li>LRU æˆ–è€… LFU æ ¹æ® Redis çš„æ·˜æ±°ç®—æ³•å†³å®šï¼›</li><li>Redis æ•°æ®ç±»å‹å’Œåº•å±‚ç¼–ç ç»“æ„ï¼›</li><li>é”®ä¿å­˜ä¸ºå­—ç¬¦ä¸²ï¼›</li><li>å€¼æ ¹æ®æ•°æ®ç±»å‹å’Œç¼–ç ç»“æ„ä¿å­˜ä¸ºä¸åŒçš„å½¢å¼ï¼›</li></ul><img src="/assets/Redisæ•°æ®ç±»å‹-6433458b.png" alt="Redisæ•°æ®ç±»å‹" style="zoom:67%;"><h4 id="é”®çš„ä¿å­˜å½¢å¼" tabindex="-1"><a class="header-anchor" href="#é”®çš„ä¿å­˜å½¢å¼" aria-hidden="true">#</a> é”®çš„ä¿å­˜å½¢å¼</h4><p>Redisä¸­é”®éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œä¸€èˆ¬çš„å­˜å‚¨å½¢å¼å¦‚ä¸‹</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>+-------------------------------+
| é”®çš„é•¿åº¦ Length | å­—ç¬¦ä¸² String |
+-------------------------------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="/assets/å­—ç¬¦ä¸²ä¿å­˜å½¢å¼-aa40456b.png" alt="å­—ç¬¦ä¸²ä¿å­˜å½¢å¼" style="zoom:50%;"><p>å‡å¦‚é”®çš„é•¿åº¦ç»Ÿä¸€ç”¨å›ºå®šé•¿åº¦ 8 å­—èŠ‚è¡¨ç¤ºï¼Œé‚£å°±æœ‰ç‚¹æµªè´¹ã€‚æ‰€ä»¥ Redis é‡‡ç”¨äº†å˜é•¿çš„æ–¹å¼æ¥è¡¨ç¤ºå­—ç¬¦ä¸²å ç”¨äº†å¤šå°‘ä½ã€‚é€šè¿‡é¦–å­—èŠ‚èƒ½å¤ŸçŸ¥é“LENGTHå­—æ®µæœ‰å¤šé•¿ï¼Œç„¶åè¯»å–LENGTHå­—æ®µå¯ä»¥çŸ¥é“å…·ä½“çš„STRINGé•¿åº¦ã€‚</p><ul><li><code>00xxxxxx</code>ï¼šå­—ç¬¦ä¸²é•¿åº¦å°äº 64</li><li><code>01xxxxxx xxxxxxxx </code> ï¼šå­—ç¬¦ä¸²é•¿åº¦å°äº 16384</li><li><code>10000000 xxxxxxxx xxxxxxxx xxxxxxxx xxxxxxxx </code> ï¼šå­—ç¬¦ä¸²é•¿åº¦ int æœ€å¤§å€¼</li><li><code>10000001 xxxxxxxx xxxxxxxx xxxxxxxx xxxxxxxx xxxxxxxx xxxxxxxx xxxxxxxx xxxxxxxx </code>ï¼šå­—ç¬¦ä¸²é•¿åº¦ long æœ€å¤§å€¼</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>00xxxxxx å­—ç¬¦ä¸²é•¿åº¦å°äº 64
01xxxxxx xxxxxxxx å­—ç¬¦ä¸²é•¿åº¦å°äº 16384
10000000 xxxxxxxx xxxxxxxx xxxxxxxx xxxxxxxx å­—ç¬¦ä¸²é•¿åº¦ int æœ€å¤§å€¼
10000001 xxxxxxxx xxxxxxxx xxxxxxxx xxxxxxxx xxxxxxxx xxxxxxxx xxxxxxxx xxxxxxxx å­—ç¬¦ä¸²é•¿åº¦ long æœ€å¤§å€¼
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>RDBä¸­å¯¹å­—ç¬¦ä¸²çš„ä¿å­˜è¿˜æœ‰ä¸¤ç§ä¼˜åŒ–å½¢å¼ï¼š</p><p>ä¸€ç§æ˜¯å°è¯•å°†å­—ç¬¦ä¸²æŒ‰æ•´å‹ä¿å­˜ï¼Œä¸€ç§æ˜¯é€šè¿‡å°†å­—ç¬¦ä¸²è¿›è¡Œ LZF å‹ç¼©ä¹‹åä¿å­˜ã€‚</p><p>å­—ç¬¦ä¸²æ•´å‹ä¿å­˜ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>+---------------------------+
| æ•´å‹çš„ç±»å‹ type | å­—ç¬¦ä¸² int |
+---------------------------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="/assets/å­—ç¬¦ä¸²æ•´å‹ä¿å­˜-310edc12.png" alt="å­—ç¬¦ä¸²æ•´å‹ä¿å­˜" style="zoom:50%;"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>11000000 xxxxxxxx    å–å€¼èŒƒå›´[-128,127]
11000001 xxxxxxxx xxxxxxxx  å–å€¼èŒƒå›´[-32768,32767]
11000010 xxxxxxxx xxxxxxxx xxxxxxxx xxxxxxxx  å–å€¼èŒƒå›´[-2147483648, 2147483647 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å­—ç¬¦ä¸² LZF å‹ç¼©ä¿å­˜ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>+-------------------------------------------------------------+
| type | å‹ç¼©ä¹‹åçš„é•¿åº¦ | å‹ç¼©ä¹‹å‰åŸå§‹å­—ç¬¦ä¸²çš„é•¿åº¦ | LZFå‹ç¼©ä¹‹åçš„æ•°æ® |
+-------------------------------------------------------------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="/assets/LZFå‹ç¼©ä¿å­˜-d907ceb6.png" alt="LZFå‹ç¼©ä¿å­˜" style="zoom:50%;"><p>TYPEé¦–å­—èŠ‚å¤´ä¸¤ä¸ªæ¯”ç‰¹ä»ç„¶ä¸º11ï¼Œåå…­ä¸ªæ¯”ç‰¹æ˜¯000011ã€‚</p><h4 id="å€¼çš„ä¿å­˜å½¢å¼" tabindex="-1"><a class="header-anchor" href="#å€¼çš„ä¿å­˜å½¢å¼" aria-hidden="true">#</a> å€¼çš„ä¿å­˜å½¢å¼</h4><p>å€¼çš„ç±»å‹æœ‰ 9 ç§ï¼Œå­—ç¬¦ä¸²ç±»å‹å’Œä¸Šé¢çš„é”®çš„ç±»å‹ä¿å­˜æ–¹å¼ä¸€è‡´ã€‚</p><p><strong>ï¼ˆ1ï¼‰list ä¿å­˜å½¢å¼</strong></p><p>quicklist ç»“æ„ï¼Œä»æ•´ä½“çœ‹æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œä½†é“¾è¡¨çš„æ¯ä¸ªèŠ‚ç‚¹åœ¨ Redis ä¸­ç¼–ç ä¸º zipList ç»“æ„ï¼Œziplist ç»“æ„åœ¨ä¸€å—è¿ç»­çš„å†…å­˜ä¸­ä¿å­˜ï¼Œå¹¶ä¸”ä¿å­˜æ—¶å¯ä»¥é€‰æ‹©è¿›è¡Œ LZF å‹ç¼©æˆ–è€…ä¸å‹ç¼©ã€‚</p><img src="/assets/quicklistç»“æ„-9be1ffe8.png" alt="quicklist ç»“æ„" style="zoom:50%;"><p>é¦–å…ˆä¿å­˜ quicklist çš„èŠ‚ç‚¹ä¸ªæ•°ï¼Œä¿å­˜æ–¹å¼åŒå›¾20-5ä¸­LENGTHå­—æ®µçš„ä¿å­˜ã€‚</p><ul><li>å¦‚æœ ziplist æœªè¿›è¡Œå‹ç¼©ï¼Œåˆ™å°†æ¯ä¸ª ziplist æŒ‰å­—ç¬¦ä¸²ä¿å­˜ï¼›</li><li>å¦‚æœ ziplist è¿›è¡Œäº†å‹ç¼©ï¼Œåˆ™å°†æ¯ä¸ªziplistæŒ‰ LZF è¿›è¡Œä¿å­˜ï¼›</li></ul><p><strong>ï¼ˆ2ï¼‰set ä¿å­˜å½¢å¼</strong></p><p>é›†åˆç±»å‹åœ¨Redisä¸­æœ‰ä¸¤ç§ç¼–ç æ–¹å¼ï¼šä¸€ç§ä¸ºintsetï¼Œå¦ä¸€ç§ä¸ºHashã€‚</p><p>intset åœ¨ Redis ä¸­ä¹Ÿæ˜¯ä¸€å—è¿ç»­çš„å†…å­˜ï¼Œæ‰€ä»¥ intset çš„ä¿å­˜æ¯”è¾ƒç®€å•ï¼Œç›´æ¥å°† intset æŒ‰å­—ç¬¦ä¸²ä¿å­˜ã€‚</p><p>å¦‚æœç¼–ç ä¸ºHashï¼Œåˆ™ä¿å­˜ç»“æ„å¦‚ä¸‹ï¼š</p><img src="/assets/setçš„hashç»“æ„-36a7b982.png" alt="setçš„hashç»“æ„" style="zoom:50%;"><p>ç¬¬ä¸€ä¸ªå­—æ®µä¸ºå­—å…¸çš„å¤§å°ï¼Œæ¥ä¸‹æ¥é€å­—æ®µä¿å­˜å­—å…¸çš„é”®ã€‚ä¸ºä»€ä¹ˆåªä¿å­˜é”®å‘¢ï¼Ÿå…¶å®é›†åˆç±»å‹ä½¿ç”¨æ•£åˆ—è¡¨ä¿å­˜æ—¶åªä½¿ç”¨äº†é”®ï¼Œæ‰€æœ‰çš„å€¼éƒ½ä¿å­˜ä¸º NULLï¼Œæ‰€ä»¥æ­¤å¤„åªéœ€è¦ä¿å­˜æ•£åˆ—è¡¨çš„é”®ã€‚</p><p><strong>ï¼ˆ3ï¼‰zset ä¿å­˜å½¢å¼</strong></p><p>æœ‰åºé›†åˆç±»å‹åœ¨ Redis ä¸­ä¹Ÿæœ‰ä¸¤ç§ç¼–ç æ–¹å¼ï¼šä¸€ç§ä¸º ziplistï¼Œå¦ä¸€ç§ä¸º skiplistã€‚</p><p>å¦‚æœç¼–ç ä¸º ziplistï¼Œå³å°† ziplist æ•´ä½“ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ä¿å­˜ã€‚</p><p>skiplist çš„ä¿å­˜æ–¹å¼å¦‚ä¸‹ï¼š</p><img src="/assets/zsetçš„skiplist-eb7f9958.png" alt="zsetçš„skiplist" style="zoom:50%;"><p>ç¬¬ä¸€ä¸ªå­—æ®µä¸ºskipliståŒ…å«çš„å…ƒç´ ä¸ªæ•°ï¼Œæ¥ç€åˆ†åˆ«æŒ‰å…ƒç´ å’Œå…ƒç´ çš„åˆ†å€¼ä¾æ¬¡ä¿å­˜ã€‚å…ƒç´ ä¿å­˜ä¸ºå­—ç¬¦ä¸²ï¼Œå…ƒç´ åˆ†å€¼ä¿å­˜ä¸ºä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°ç±»å‹ï¼ˆå›ºå®šä¸º8ä¸ªå­—èŠ‚ï¼‰ã€‚</p><p><strong>ï¼ˆ4ï¼‰hash ä¿å­˜å½¢å¼</strong></p><p>æ•£åˆ—ç±»å‹ä¹Ÿæœ‰ä¸¤ç§ç¼–ç æ–¹å¼ï¼šä¸€ç§ä¸º ziplistï¼Œä¸€ç§ hashã€‚</p><p>ziplist ç¼–ç æ–¹å¼çš„ä¿å­˜åŒæœ‰åºé›†åˆï¼Œ</p><p>hash ç»“æ„å¦‚ä¸‹å¦‚ä¸‹</p><img src="/assets/hashçš„hashç»“æ„-e824c254.png" alt="hashçš„hashç»“æ„" style="zoom:50%;"><p>ç¬¬ä¸€ä¸ªå­—æ®µä¸ºæ•£åˆ—è¡¨çš„å¤§å°ï¼Œç„¶åä¾æ¬¡ä¿å­˜é”®å€¼å¯¹ï¼Œé”®å€¼éƒ½ä¿å­˜ä¸ºå­—ç¬¦ä¸²ç±»å‹ã€‚</p><p><strong>(5) stream ä¿å­˜å½¢å¼</strong></p><p>Streamä¿å­˜ä¸ºRDBæ–‡ä»¶æ—¶æ•´ä½“æ ¼å¼</p><img src="/assets/RDBä¸­çš„streamç»“æ„-f4693992.png" alt="RDBä¸­çš„streamç»“æ„" style="zoom:67%;"><p>å…¶ä¸­ä¿å­˜æ¶ˆè´¹ç»„çš„PELæ—¶å¹¶æ²¡æœ‰ä¿å­˜ç›¸å…³æ¶ˆè´¹è€…çš„ä¿¡æ¯ï¼Œè€Œæ˜¯åœ¨åŠ è½½å®Œæ¶ˆè´¹è€…ä¹‹åï¼Œä»æ¶ˆè´¹è€…çš„PELä¸­æŸ¥æ‰¾å¹¶æ›´æ–°æ¶ˆè´¹ç»„PELçš„ç›¸å…³ä¿¡æ¯</p><h3 id="åŠ è½½-rdb-æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#åŠ è½½-rdb-æ–‡ä»¶" aria-hidden="true">#</a> åŠ è½½ RDB æ–‡ä»¶</h3><p>å½“ Redis æœåŠ¡å™¨å¯åŠ¨æ—¶ï¼Œä¼šåœ¨å·¥ä½œç›®å½•ä¸­æŸ¥æ‰¾æ˜¯å¦æœ‰ RDB æ–‡ä»¶ï¼Œå¦‚æœæœ‰å°±ä¼šæ‰“å¼€å®ƒï¼Œç„¶åè¯»å–æ–‡ä»¶çš„å†…å®¹å¹¶æ‰§è¡Œä¸‹é¢çš„æ“ä½œï¼š</p><ul><li>æ£€æŸ¥æ–‡ä»¶å¼€å¤´çš„æ ‡è¯†ç¬¦æ˜¯å¦æ˜¯â€œREDISâ€ï¼›</li><li>æ£€æŸ¥ RDB æ–‡ä»¶çš„ RDB çš„ç‰ˆæœ¬ï¼Œç”¨äºåˆ¤æ–­å½“å‰ç‰ˆæœ¬çš„ Redis èƒ½å¦åŠ è½½è¿™ä¸ª RDB æ–‡ä»¶ï¼›</li><li>æ ¹æ®æ–‡ä»¶ä¸­è®°å½•çš„è®¾å¤‡é™„åŠ ä¿¡æ¯ï¼Œæ‰§è¡Œç›¸åº”çš„æ“ä½œå’Œè®¾ç½®ï¼›</li><li>æ£€æŸ¥æ–‡ä»¶çš„æ•°æ®åº“æ•°æ®éƒ¨åˆ†æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ä¸ºç©ºå°±å»å°è¯•åŠ è½½ <ul><li>æ ¹æ®æ•°æ®åº“ç¼–å·ï¼Œåˆ‡æ¢åˆ°å¯¹åº”çš„æ•°æ®åº“ï¼›</li><li>æ ¹æ®é”®å€¼å¯¹æ€»æ•°é‡å’Œå¸¦è¿‡æœŸæ—¶é—´çš„é”®å€¼å¯¹æ€»æ•°é‡ï¼Œè®¾ç½®æ•°æ®åº“çš„åº•å±‚ç»“æ„ï¼›</li><li>ä¾æ¬¡è½½å…¥æ‰€æœ‰é”®å€¼å¯¹æ•°æ®ï¼›</li></ul></li><li>å¦‚æœæœåŠ¡å™¨å¼€å¯äº†å¤åˆ¶åŠŸèƒ½ï¼Œéœ€è¦å°†ä¹‹å‰ç¼“å­˜çš„ Lua è„šæœ¬é‡æ–°è½½å…¥åˆ°ç¼“å­˜ä¸­ï¼›</li><li>é‡åˆ° EOF æ ‡å¿—ï¼Œè¡¨ç¤º RDB æ–‡ä»¶å·²ç»è¯»å–å®Œæ¯•ï¼›</li><li>æ ¡éªŒæ–‡ä»¶æœ«å°¾çš„ CRC64 æ ¡éªŒå’Œï¼Œåˆ¤æ–­æ˜¯å¦å’ŒåŠ è½½æœŸé—´è®¡ç®—å¾—åˆ°çš„ CRC64 çš„å€¼æ˜¯å¦ç›¸ç­‰ï¼Œç”¨æ¥åˆ¤æ–­åŠ è½½çš„æ•°æ®æ˜¯å¦å®Œå¥½æ— æŸï¼›</li><li>RDB æ–‡ä»¶åŠ è½½å®Œæˆï¼Œå¼€å§‹æ¥æ”¶æœåŠ¡ç«¯çš„è¯·æ±‚ï¼›</li></ul><h3 id="rdb-ä¼˜ç¼ºç‚¹" tabindex="-1"><a class="header-anchor" href="#rdb-ä¼˜ç¼ºç‚¹" aria-hidden="true">#</a> RDB ä¼˜ç¼ºç‚¹</h3><p><strong>RDB æŒä¹…åŒ–çš„ä¼˜ç‚¹ï¼š</strong></p><ol><li>RDB æ˜¯ä¸€ä¸ªè¿›ç´§å‡‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä»£è¡¨æŸä¸ªæ—¶é—´ç‚¹ä¸Šçš„æ•°æ®å¿«ç…§ã€‚éå¸¸é€‚åˆå¤‡ä»½ï¼Œå…¨é‡å¤åˆ¶ç­‰åœºæ™¯ã€‚æˆ‘ä»¬å¯ä»¥æ¯éš”å‡ ä¸ªå°æ—¶æ‰§è¡Œ bgsave å¤‡ä»½ï¼›</li><li>Redis åŠ è½½ RDB æ–‡ä»¶æ¢å¤æ•°æ®çš„é€Ÿåº¦æ¯” AOF çš„æ–¹å¼å¿«å¾ˆå¤šï¼›</li></ol><p><strong>RBD æŒä¹…åŒ–çš„ç¼ºç‚¹</strong></p><ol><li>ä½¿ç”¨ RDB æŒä¹…åŒ–ç­–ç•¥ï¼Œå¯èƒ½ä¼šä¸¢å¤±å‡ åˆ†é’Ÿçš„æ•°æ®ã€‚å› ä¸º RDB æ˜¯ä¸€ç§æ—¶é—´ç‚¹å¿«ç…§ï¼ˆpoint-in-time snapshotï¼‰ï¼Œå¯¹äº RDB æŒä¹…åŒ–æ¥è¯´ï¼ŒæœåŠ¡å™¨åœæœºæ—¶ä¸¢å¤±çš„æ•°æ®é‡å–å†³äºæœ€åä¸€æ¬¡æˆåŠŸæ‰§è¡Œ RDB æŒä¹…åŒ–æ“ä½œçš„å¼€å§‹æ‰§è¡Œæ—¶é—´ã€‚</li><li>ä¸ºäº†ä½¿ç”¨å­è¿›ç¨‹æŒä¹…åŒ–åˆ°ç£ç›˜ï¼ŒRDB éœ€è¦ç»å¸¸è°ƒç”¨ fork()ã€‚å¦‚æœæ•°æ®é›†å¾ˆå¤§ï¼Œfork() å¯èƒ½ä¼šè€—è´¹å¾ˆé•¿æ—¶é—´ï¼Œå¹¶ä¸”å¦‚æœæ•°æ®é›†éå¸¸å¤§ä¸” CPU æ€§èƒ½ä¸å¤ªå¥½ï¼Œåˆ™å¯èƒ½å¯¼è‡´ Redis åœ¨å‡ æ¯«ç§’ç”šè‡³ä¸€ç§’é’Ÿå†…åœæ­¢ä¸ºå®¢æˆ·ç«¯æä¾›æœåŠ¡ï¼›</li></ol><h2 id="aof-æŒä¹…åŒ–" tabindex="-1"><a class="header-anchor" href="#aof-æŒä¹…åŒ–" aria-hidden="true">#</a> AOF æŒä¹…åŒ–</h2><p>RDB æ˜¯å…¨é‡å¼çš„æŒä¹…åŒ–ï¼Œè€Œ AOF æ˜¯å¢é‡å¼æŒä¹…åŒ–ã€‚æ ¸å¿ƒåŸç†ï¼šæœåŠ¡å™¨æ¯æ¬¡æ‰§è¡Œå®Œå†™å‘½ä»¤ä¹‹åï¼Œéƒ½ä¼šä»¥åè®®æ–‡æœ¬çš„æ–¹å¼å°†è¢«æ‰§è¡Œçš„å‘½ä»¤è¿½åŠ åˆ° AOF æ–‡ä»¶çš„æœ«å°¾ã€‚åœ¨æœåŠ¡å™¨åœæœºä¹‹åï¼Œåªè¦é‡æ–°æ‰§è¡Œ AOF æ–‡ä»¶ä¸­ä¿å­˜çš„å‘½ä»¤ï¼Œå°±å¯ä»¥å°†æ•°æ®åº“æ¢å¤åˆ°åœæœºä¹‹å‰çš„çŠ¶æ€ã€‚</p><p>Redis åœ¨æ”¶åˆ°å®¢æˆ·ç«¯ä¿®æ”¹æŒ‡ä»¤ä¹‹åï¼Œè¿›è¡Œå‚æ•°æ ¡éªŒã€é€»è¾‘å¤„ç†ï¼Œå¦‚æœæ²¡æœ‰é—®é¢˜å°±ç«‹å³å°†è¯¥æŒ‡ä»¤æ–‡æœ¬å­˜å‚¨åˆ° AOF æ—¥å¿—ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´å…ˆæ‰§è¡ŒæŒ‡ä»¤å†å°†æ—¥å¿—è½ç›˜ã€‚</p><p>éšç€æ—¶é—´ AOF çš„æ—¥å¿—ä¼šè¶Šæ¥è¶Šé•¿ï¼ŒRedis æä¾›äº†é‡å†™åŠŸèƒ½ï¼Œè¯¥åŠŸèƒ½èƒ½å¤Ÿç”Ÿæˆä¸€ä¸ªå…¨æ–°çš„ AOF æ–‡ä»¶ï¼Œå¹¶ä¸”æ–‡ä»¶ä¸­åªåŒ…å«æ¢å¤å½“å‰æ•°æ®åº“æ‰€éœ€çš„å°½å¯èƒ½å°‘çš„å‘½ä»¤ã€‚</p><p>AOF æ–‡ä»¶åœ¨ 7.0.0 çš„æ—¶å€™ï¼ŒåŸæ¥çš„å•ä¸ª AOF æ–‡ä»¶è¢«åˆ†æˆåŸºç¡€æ–‡ä»¶ï¼ˆæœ€å¤šä¸€ä¸ªï¼‰å’Œå¢é‡æ–‡ä»¶ï¼ˆå¯èƒ½æœ‰å¤šä¸ªï¼‰</p><blockquote><p>å®˜ç½‘åŸæ–‡ï¼šSince Redis 7.0.0, Redis uses a multi part AOF mechanism. That is, the original single AOF file is split into base file (at most one) and incremental files (there may be more than one). The base file represents an initial (RDB or AOF format) snapshot of the data present when the AOF is <a href="https://redis.io/docs/management/persistence/#log-rewriting" target="_blank" rel="noopener noreferrer">rewritten<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>. The incremental files contains incremental changes since the last base AOF file was created. All these files are put in a separate directory and are tracked by a manifest file.</p></blockquote><h3 id="aof-å·¥ä½œæµç¨‹" tabindex="-1"><a class="header-anchor" href="#aof-å·¥ä½œæµç¨‹" aria-hidden="true">#</a> AOF å·¥ä½œæµç¨‹</h3><p>Redis 3.0 çš„æµç¨‹</p><img src="/assets/aofå·¥ä½œæµç¨‹-52e9d768.png" alt="aofå·¥ä½œæµç¨‹" style="zoom:50%;"><ol><li>æ‰€æœ‰çš„å†™å…¥å‘½ä»¤ä¼šè¿½åŠ åˆ° aof_bufï¼ˆ ç¼“å†²åŒºï¼‰ä¸­ï¼›</li><li>AOF ç¼“å†²åŒºæ ¹æ®å¯¹åº”çš„ç­–ç•¥å‘ç¡¬ç›˜åšåŒæ­¥æ“ä½œï¼›</li><li>éšç€ AOF æ–‡ä»¶è¶Šæ¥è¶Šå¤§ï¼Œ éœ€è¦å®šæœŸå¯¹ AOF æ–‡ä»¶è¿›è¡Œé‡å†™ï¼Œ è¾¾åˆ°å‹ç¼©çš„ç›®çš„ï¼›</li><li>å½“ Redis æœåŠ¡å™¨é‡å¯æ—¶ï¼Œ å¯ä»¥åŠ è½½ AOF æ–‡ä»¶è¿›è¡Œæ•°æ®æ¢å¤ï¼›</li></ol><blockquote><p>AOF æ–‡ä»¶å­˜çš„å°±æ˜¯ Redis åè®®æ ¼å¼</p></blockquote><h3 id="aof-æ–‡ä»¶åˆ·æ–°é¢‘ç‡" tabindex="-1"><a class="header-anchor" href="#aof-æ–‡ä»¶åˆ·æ–°é¢‘ç‡" aria-hidden="true">#</a> AOF æ–‡ä»¶åˆ·æ–°é¢‘ç‡</h3><p>ä¸ºä»€ä¹ˆè¦æŠŠå‘½ä»¤å…ˆå†™å…¥åˆ°ä¸€ä¸ªç¼“å†²åŒºä¸­å‘¢ï¼Ÿå› ä¸ºå¦‚æœæ¯æ¬¡éƒ½æŠŠ AOF æ–‡ä»¶å‘½ä»¤éƒ½ç›´æ¥åˆ·æ–°åˆ°ç£ç›˜ï¼Œæ€§èƒ½å¾ˆä½ã€‚ä¸€èˆ¬çš„æ“ä½œæ—¶ï¼Œå°†å¯¹ç¡¬ç›˜çš„å¤šæ¬¡å†™å…¥æ“ä½œä¼˜åŒ–æˆä¸€æ¬¡å†™å…¥æ“ä½œï¼Œå½“ç¨‹åºè°ƒç”¨ write ç³»ç»Ÿè°ƒç”¨å¯¹æ–‡ä»¶è¿›è¡Œå†™å…¥æ—¶ï¼Œç³»ç»Ÿä¼šå°†æ•°æ®å†™å…¥ä½äºå†…å­˜çš„ç¼“å†²åŒºä¸­ï¼Œç­‰åˆ°æŒ‡å®šçš„æ—¶é•¿æˆ–è€…æ»¡è¶³æŸäº›å†™å…¥æ¡ä»¶æ—¶ï¼Œç³»ç»Ÿæ‰ä¼šæ‰§è¡Œ flush ç³»ç»Ÿè°ƒç”¨ï¼Œå°†ç¼“å†²åŒºä¸­çš„æ•°æ®åˆ·æ–°åˆ°ç£ç›˜ã€‚</p><p>Redis æä¾›äº†ä¸‰ç§ AOF æ–‡ä»¶åˆ·æ–°é¢‘ç‡çš„é…ç½®ï¼Œç”±å‚æ•° appendfsync æ§åˆ¶ï¼š</p><ul><li>alwaysï¼šæ¯æ‰§è¡Œä¸€ä¸ªå†™å‘½ä»¤ï¼Œå°±å¯¹ AOF æ–‡ä»¶æ‰§è¡Œä¸€æ¬¡åˆ·æ–°æ“ä½œã€‚ä¹Ÿå°±æ˜¯å‘½ä»¤å†™å…¥ç¼“å†²åŒºåè°ƒç”¨ç³»ç»Ÿè°ƒç”¨ fsync æ“ä½œåŒæ­¥åˆ° AOF æ–‡ä»¶ï¼Œfsync åçº¿ç¨‹ç«‹å³è¿”å›ï¼›</li><li>everysecï¼šæ¯éš” 1sï¼Œå°±å¯¹ AOF æ–‡ä»¶æ‰§è¡Œä¸€æ¬¡åˆ·æ–°æ“ä½œã€‚ä¹Ÿå°±æ˜¯å‘½ä»¤å†™å…¥ç¼“å†²åŒºåè°ƒç”¨ç³»ç»Ÿè°ƒç”¨ write æ“ä½œï¼Œwrite å®Œåçº¿ç¨‹è¿”å›ã€‚ fsync åŒæ­¥åˆ° AOF æ–‡ä»¶çš„æ“ä½œæœ‰ä¸“é—¨çš„çº¿ç¨‹æ§åˆ¶ 1s ä¸€æ¬¡ï¼›</li><li>noï¼šä¸ä¸»åŠ¨å¯¹ AOF è¿›è¡Œåˆ·æ–°æ“ä½œï¼Œç”±æ“ä½œç³»ç»Ÿå†³å®šä»€ä¹ˆæ—¶å€™å¯¹ AOF è¿›è¡Œåˆ·æ–°ã€‚ä¹Ÿå°±æ˜¯å‘½ä»¤å†™å…¥ç¼“å†²åŒºåè°ƒç”¨ç³»ç»Ÿè°ƒç”¨ write æ“ä½œï¼Œwrite å®Œåçº¿ç¨‹è¿”å›ã€‚ ä¸å¯¹ AOF æ–‡ä»¶åš fsync æ“ä½œï¼ŒåŒæ­¥åˆ°ç£ç›˜çš„æ“ä½œç”±æ“ä½œç³»ç»Ÿæ§åˆ¶ï¼Œä¸€èˆ¬åŒæ­¥å‘¨æœŸæœ€é•¿ 30 ç§’ï¼›</li></ul><p>fsync é’ˆå¯¹å•ä¸ªæ–‡ä»¶æ“ä½œï¼Œåšå¼ºåˆ¶ç£ç›˜åŒæ­¥ï¼Œfsync å°†é˜»å¡ç›´åˆ°å†™å…¥ç¡¬ç›˜å®Œæˆåè¿”å›ï¼Œä¿è¯äº†æ•°æ®çš„æŒä¹…åŒ–ã€‚</p><h3 id="aof-é‡å†™" tabindex="-1"><a class="header-anchor" href="#aof-é‡å†™" aria-hidden="true">#</a> AOF é‡å†™</h3><p>éšç€å‘½ä»¤ä¸æ–­å†™å…¥ AOF æ–‡ä»¶ï¼ŒAOF æ–‡ä»¶ä¼šè¶Šæ¥è¶Šå¤§ï¼ŒRedis ä½¿ç”¨é‡å†™æœºåˆ¶å‹ç¼©æ–‡ä»¶ä½“ç§¯ã€‚AOF æ–‡ä»¶é‡å†™æ˜¯æŠŠ Redis è¿›ç¨‹å†…çš„æ•°æ®è½¬åŒ–ä¸ºå†™å‘½ä»¤åŒæ­¥åˆ°æ–°çš„ AOF æ–‡ä»¶çš„è¿‡ç¨‹ï¼›</p><p>ä¸ºä»€ä¹ˆ AOF æ–‡ä»¶å¯ä»¥å‹ç¼©å‘¢ï¼Ÿ</p><p>å¦‚æœå¯¹ç›¸åŒçš„é”®æ‰§è¡Œè¿‡å¤šæ¬¡ä¿®æ”¹ï¼Œé‚£ä¹ˆ AOF æ–‡ä»¶ä¸­ä¼šå‡ºç°å¤šä¸ªå†—ä½™å‘½ä»¤ï¼›å¤šæ¡å†™å‘½ä»¤å¯ä»¥åˆå¹¶æˆä¸€ä¸ªï¼Œä¾‹å¦‚ lpush list aã€lpush list bã€lpush list c å¯ä»¥è½¬åŒ–ä¸º lpush list a b cã€‚ä¸ºäº†é˜²æ­¢å•æ¡å‘½ä»¤è¿‡å¤§é€ æˆå®¢æˆ·ç«¯ç¼“å†²åŒºæº¢å‡ºï¼Œå¯¹äº listã€ setã€ hashã€ zset ç­‰ç±»å‹æ“ä½œï¼Œ ä»¥ 64 ä¸ªå…ƒç´ ä¸ºç•Œæ‹†åˆ†ä¸ºå¤šæ¡ã€‚</p><p>AOF é‡å†™åŒæ ·æ˜¯åŸºäº copy-on-write å®ç°çš„ã€‚</p><blockquote><p>Since Redis 7.0.0, when an AOF rewrite is scheduled, the Redis parent process opens a new incremental AOF file to continue writing. The child process executes the rewrite logic and generates a new base AOF. Redis will use a temporary manifest file to track the newly generated base file and incremental file. When they are ready, Redis will perform an atomic replacement operation to make this temporary manifest file take effect. In order to avoid the problem of creating many incremental files in case of repeated failures and retries of an AOF rewrite, Redis introduces an AOF rewrite limiting mechanism to ensure that failed AOF rewrites are retried at a slower and slower rate.</p></blockquote><h4 id="bgrewriteaof-å‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#bgrewriteaof-å‘½ä»¤" aria-hidden="true">#</a> BGREWRITEAOF å‘½ä»¤</h4><blockquote><p>https://redis.io/commands/bgrewriteaof/</p></blockquote><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Available since:1.0.0
Time complexity:O(1)
ACL categories:@admin, @slow, @dangerous
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ BGREWRITEAOF æ˜¾ç¤ºè§¦å‘ AOF é‡å†™æ“ä½œã€‚æ˜¯ä¸€ä¸ªå¼‚æ­¥å‘½ä»¤ï¼ŒRedis æœåŠ¡å™¨æ¥æ”¶åˆ°è¿™ä¸ªå‘½ä»¤ä¹‹åä¼šåˆ›å»ºå‡ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œç”±å®ƒæ‰«ææ•´ä¸ªæ•°æ®åº“å¹¶ç”Ÿæˆæ–°çš„ AOF æ–‡ä»¶ã€‚å½“</p><p>Redis 3.0 çš„æµç¨‹</p><img src="/assets/bgrewriteaofæµç¨‹-034d51e1.png" alt="bgrewriteaofæµç¨‹" style="zoom:50%;"><ol><li>æ‰§è¡Œ AOF é‡å†™è¯·æ±‚ <ol><li>å¦‚æœå½“å‰è¿›ç¨‹æ­£åœ¨æ‰§è¡Œ AOF é‡å†™ï¼Œè¯·æ±‚ä¸æ‰§è¡Œï¼Œè¿”å› ERR Background append only file rewriting already in progressï¼›</li><li>å¦‚æœå½“å‰è¿›ç¨‹æ­£åœ¨æ‰§è¡Œ bgsave æ“ä½œï¼Œé‡å†™å‘½ä»¤å»¶è¿Ÿåˆ° bgsave å®Œæˆä¹‹åå†æ‰§è¡Œã€‚è¿”å› Background append only file rewriting scheduledï¼›</li></ol></li><li>çˆ¶è¿›ç¨‹ fork åˆ›å»ºå­çº¿ç¨‹ï¼Œå¼€é”€ç­‰äº bgsave è¿‡ç¨‹ï¼›</li><li>fork æ“ä½œå®Œæˆå <ol><li>ä¸»çº¿ç¨‹ fork æ“ä½œå®Œæˆåï¼Œç»§ç»­å“åº”å…¶ä»–å‘½ä»¤ã€‚æ‰€æœ‰ä¿®æ”¹å‘½ä»¤å†™å…¥ AOF ç¼“å†²åŒºï¼Œå¹¶æ ¹æ® appendfsync ç­–ç•¥åŒæ­¥åˆ°ç£ç›˜ï¼Œä¿è¯åŸæœ‰ AOF æœºåˆ¶çš„æ­£ç¡®æ€§ï¼›</li><li>ç”±äº fork æ“ä½œè¿ç”¨ copy-on-write æŠ€æœ¯ï¼Œå­è¿›ç¨‹åªèƒ½å…±äº« fork æ“ä½œæ—¶çš„å†…å­˜æ•°æ®ã€‚ç”±äºçˆ¶è¿›ç¨‹ä¾ç„¶å“åº”å‘½ä»¤ï¼ŒRedis ä½¿ç”¨ AOF é‡å†™ç¼“å†²åŒºä¿å­˜è¿™éƒ¨åˆ†æ–°æ•°æ®ï¼Œé˜²æ­¢æ–° AOF æ–‡ä»¶ç”ŸæˆæœŸé—´ä¸¢å¤±è¿™éƒ¨åˆ†æ•°æ®ï¼›</li></ol></li><li>å­è¿›ç¨‹æ ¹æ®å†…å­˜å¿«ç…§ï¼ŒæŒ‰ç…§å‘½ä»¤åˆå¹¶è§„åˆ™å†™å…¥åˆ°æ–°çš„ AOF æ–‡ä»¶ã€‚æ¯æ¬¡æ‰¹é‡å†™å…¥ç£ç›˜æ•°æ®é‡ç”±é…ç½® aof-rewrite-incremental-fsync æ§åˆ¶ï¼Œé»˜è®¤ä¸º 32MBï¼Œé˜²æ­¢å•æ¬¡åˆ·ç›˜æ•°æ®é€ æˆç¡¬ç›˜é˜»å¡ï¼›</li><li>æ–° AOF æ–‡ä»¶å®Œæˆ <ol><li>æ–° AOF æ–‡ä»¶å†™å…¥å®Œæˆåï¼Œå­è¿›ç¨‹å‘é€ä¿¡å·ç»™çˆ¶è¿›ç¨‹ï¼Œçˆ¶è¿›ç¨‹æ›´æ–°ç»Ÿè®¡ä¿¡æ¯ï¼›</li><li>çˆ¶è¿›ç¨‹æŠŠ AOF é‡å†™ç¼“å†²åŒºçš„æ•°æ®å†™å…¥åˆ°æ–°çš„ AOF æ–‡ä»¶ï¼›</li><li>ä½¿ç”¨æ–°çš„ AOF æ–‡ä»¶æ›¿æ¢è€æ–‡ä»¶ï¼Œå®Œæˆ AOF é‡å†™ï¼›</li></ol></li></ol><blockquote><p>å¦‚æœç”¨æˆ·å‘é€ BGREWRITEAOF å‘½ä»¤è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨æ­£åœ¨åˆ›å»º RDB æ–‡ä»¶ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°†æŠŠ AOF é‡å†™æ“ä½œå»¶è¿Ÿååˆ° RDB æ–‡ä»¶åˆ›å»ºå®Œæ¯•ä¹‹åå†æ‰§è¡Œï¼Œä»è€Œé¿å…ä¸¤ä¸ªå†™ç¡¬ç›˜æ“ä½œåŒæ—¶æ‰§è¡Œå¯¼è‡´æœºå™¨æ€§èƒ½ä¸‹é™ï¼›å¦‚æœæœåŠ¡å™¨åœ¨æ‰§è¡Œé‡å†™æ“ä½œè¿‡ç¨‹ä¸­ï¼Œæœ‰æ¥æ”¶åˆ°äº†æ–°çš„ BGREWRITEAOF å‘½ä»¤è¯·æ±‚æ—¶ï¼Œé‚£ä¹ˆæœåŠ¡å™¨ä¼šç›´æ¥è¿”å›ä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼›</p></blockquote><p>å®˜ç½‘çš„è§£é‡Šï¼š</p><p><strong>Redis &lt; 7.0</strong></p><ul><li>AOF can use a lot of memory if there are writes to the database during a rewrite (these are buffered in memory and written to the new AOF at the end).</li><li>All write commands that arrive during rewrite are written to disk twice.</li><li>Redis could freeze writing and fsyncing these write commands to the new AOF file at the end of the rewrite.</li></ul><p>å…³äº Redis 7.0 ä»¥ä¸Šçš„ AOF é‡å†™æµç¨‹æ˜¯ä¸ä¸€æ ·äº†ï¼Œå› ä¸º AOF æ–‡ä»¶åˆ†æˆäº†å¤šä¸ªï¼Œå…·ä½“è§å®˜ç½‘ã€‚</p><h4 id="aof-é‡å†™é…ç½®é€‰é¡¹" tabindex="-1"><a class="header-anchor" href="#aof-é‡å†™é…ç½®é€‰é¡¹" aria-hidden="true">#</a> AOF é‡å†™é…ç½®é€‰é¡¹</h4><p>æ‰“å¼€ aof æŒä¹…åŒ–åŠŸèƒ½ï¼šappendonly yesï¼›</p><p>å¯ä»¥é€šè¿‡è®¾ç½®ä¸‹é¢ä¸¤ä¸ªé…ç½®é€‰é¡¹è®© Redis è‡ªåŠ¨è§¦å‘ BGREWRITEAOFã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>auto-aof-rewrite-min-size è¡¨ç¤ºè¿è¡ŒAOFé‡å†™æ—¶æ–‡ä»¶æœ€å°ä½“ç§¯ã€‚</p><p>auto-aof-rewrite-min-size æ§åˆ¶è§¦å‘è‡ªåŠ¨ AOF æ–‡ä»¶é‡å†™æ‰€éœ€çš„æ–‡ä»¶ä½“ç§¯å¢å¤§æ¯”ä¾‹ï¼Œå‡å¦‚é…ç½®çš„æ˜¯ 100ï¼Œè¡¨ç¤ºå¦‚æœå½“å‰ AOF æ–‡ä»¶çš„ä½“ç§¯æ¯”ä¸Šä¸€æ¬¡ AOF æ–‡ä»¶é‡å†™ä¹‹åçš„ä½“ç§¯å¢å¤§äº† 100%ï¼Œé‚£ä¹ˆå°†è‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡ BGREWRITEAOF å‘½ä»¤ã€‚</p><h3 id="æ–‡ä»¶æ ¡éªŒ" tabindex="-1"><a class="header-anchor" href="#æ–‡ä»¶æ ¡éªŒ" aria-hidden="true">#</a> æ–‡ä»¶æ ¡éªŒ</h3><p>åŠ è½½æŸåçš„ AOF æ–‡ä»¶æ—¶ä¼šæ‹’ç»å¯åŠ¨ï¼Œ å¯¹äºé”™è¯¯æ ¼å¼çš„ AOF æ–‡ä»¶ï¼Œ å…ˆè¿›è¡Œå¤‡ä»½ï¼Œ ç„¶åé‡‡ç”¨ redis-check-aof --fix å‘½ä»¤è¿›è¡Œä¿®å¤ï¼Œ ä¿®å¤åä½¿ç”¨ diff-u å¯¹æ¯”æ•°æ®çš„å·®å¼‚ï¼Œ æ‰¾å‡ºä¸¢å¤±çš„æ•°æ®ï¼Œ æœ‰äº›å¯ä»¥äººå·¥ä¿®æ”¹è¡¥å…¨ã€‚</p><h4 id="æ–‡ä»¶å°¾éƒ¨æŸå" tabindex="-1"><a class="header-anchor" href="#æ–‡ä»¶å°¾éƒ¨æŸå" aria-hidden="true">#</a> æ–‡ä»¶å°¾éƒ¨æŸå</h4><p>AOF æ–‡ä»¶å¯èƒ½å­˜åœ¨ç»“å°¾ä¸å®Œæ•´çš„æƒ…å†µï¼Œ æ¯”å¦‚æœºå™¨çªç„¶æ‰ç”µå¯¼è‡´ AOF å°¾éƒ¨æ–‡ä»¶å‘½ä»¤å†™å…¥ä¸å…¨ã€‚ Redis ä¸ºæˆ‘ä»¬æä¾›äº†aof-load-truncated é…ç½®æ¥å…¼å®¹è¿™ç§æƒ…å†µï¼Œ é»˜è®¤å¼€å¯ã€‚ åŠ è½½ AOF æ—¶ï¼Œ å½“é‡åˆ°æ­¤é—®é¢˜æ—¶ä¼šå¿½ç•¥å¹¶ç»§ç»­å¯åŠ¨ï¼Œ åŒæ—¶æ‰“å°å¦‚ä¸‹è­¦å‘Šæ—¥å¿—ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>* Reading RDB preamble from AOF file...
* Reading the remaining AOF tail...
# !!! Warning: short read while loading the AOF file !!!
# !!! Truncating the AOF at offset 439 !!!
# AOF loaded anyway because aof-load-truncated is enabled
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p><ul><li><p>å¤‡ä»½æ‚¨çš„ AOF æ–‡ä»¶ã€‚</p></li><li><p>ä½¿ç”¨ Redis é™„å¸¦çš„ redis-check-aof å·¥å…·ä¿®å¤åŸå§‹æ–‡ä»¶</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ redis-check-aof --fix &lt;filename&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>å¯é€‰æ‹©ä½¿ç”¨ diff -u æ£€æŸ¥ä¸¤ä¸ªæ–‡ä»¶ä¹‹é—´çš„å·®å¼‚ã€‚</p></li><li><p>ä½¿ç”¨è§£å†³åçš„æ–‡ä»¶é‡æ–°å¯åŠ¨æœåŠ¡å™¨ã€‚</p></li></ul><h4 id="æ–‡ä»¶ä¸­é—´æŸå" tabindex="-1"><a class="header-anchor" href="#æ–‡ä»¶ä¸­é—´æŸå" aria-hidden="true">#</a> æ–‡ä»¶ä¸­é—´æŸå</h4><p>å¦‚æœ AOF æ–‡ä»¶ä¸ä»…è¢«æˆªæ–­ï¼Œè€Œä¸”åœ¨ä¸­é—´è¢«æ— æ•ˆå­—èŠ‚åºåˆ—æŸåï¼Œäº‹æƒ…ä¼šæ›´å¤æ‚ã€‚ Redis ä¼šåœ¨å¯åŠ¨æ—¶æŠ¥é”™å¹¶ä¸­æ­¢ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>* Reading the remaining AOF tail...
# Bad file format reading the append only file: make a backup of your AOF file, then use ./redis-check-aof --fix &lt;filename&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ€å¥½çš„åšæ³•æ˜¯é¦–å…ˆè¿è¡Œ redis-check-aof ç¨‹åºï¼Œä¸ä½¿ç”¨ --fix sé€‰é¡¹ï¼Œç„¶åäº†è§£é—®é¢˜ï¼Œè·³è½¬åˆ°æ–‡ä»¶ä¸­ç»™å®šçš„åç§»é‡ï¼Œå¹¶æŸ¥çœ‹æ˜¯å¦å¯ä»¥æ‰‹åŠ¨ä¿®å¤æ–‡ä»¶ï¼šAOF ä½¿ç”¨ä¸ Redis åè®®ç›¸åŒçš„æ ¼å¼ï¼Œæ‰‹åŠ¨ä¿®å¤ç›¸å½“ç®€å•ã€‚å¦åˆ™ï¼Œå¯ä»¥è®©ç¨‹åºä¸ºæˆ‘ä»¬ä¿®å¤æ–‡ä»¶ï¼Œä½†åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»æ— æ•ˆéƒ¨åˆ†åˆ°æ–‡ä»¶æœ«å°¾çš„æ‰€æœ‰ AOF éƒ¨åˆ†å¯èƒ½ä¼šè¢«ä¸¢å¼ƒï¼Œå¦‚æœæŸåå‘ç”Ÿåœ¨æ–‡ä»¶çš„åˆå§‹éƒ¨åˆ†ï¼Œåˆ™å¯èƒ½å¯¼è‡´å¤§é‡æ•°æ®ä¸¢å¤±ã€‚</p><h3 id="aof-çš„ä¼˜ç¼ºç‚¹" tabindex="-1"><a class="header-anchor" href="#aof-çš„ä¼˜ç¼ºç‚¹" aria-hidden="true">#</a> AOF çš„ä¼˜ç¼ºç‚¹</h3><p>ä¼˜ç‚¹å°±æ˜¯ AOF æŒä¹…åŒ–çš„å®‰å…¨æ€§è¦é«˜å¾ˆå¤šï¼Œé€šè¿‡ä½¿ç”¨ everysec é€‰é¡¹ï¼Œç”¨æˆ·å¯ä»¥å°†æ•°æ®ä¸¢å¤±çš„æ—¶é—´é™åˆ¶åœ¨ 1s ä»¥å†…ã€‚</p><p>ç¼ºç‚¹ï¼š</p><ul><li>AOF å­˜å‚¨çš„æ˜¯åè®®æ–‡æœ¬ï¼Œæ‰€ä»¥ä½“ç§¯ä¼šæ¯”ç›¸åŒæ•°æ®é‡çš„ RBD æ–‡ä»¶è¦å¤§å¾ˆå¤šï¼Œå¹¶ä¸”ç”Ÿæˆ AOF æ–‡ä»¶éœ€è¦çš„æ—¶é—´ä¹Ÿæ¯” RDB æ–‡ä»¶è¦é•¿ï¼›</li><li>RDB çš„æ¢å¤æ•°æ®çš„é€Ÿåº¦è¦æ¯” AOF å—å¾ˆå¤šã€‚å› ä¸º RDB æ˜¯ç›´æ¥çš„æ•°æ®æ¢å¤æ“ä½œï¼ŒAOF æ˜¯é—´æ¥çš„æ•°æ®æ¢å¤æ“ä½œï¼Œå®ƒè¦é€šè¿‡æ‰§è¡Œå‘½ä»¤æ¥æ¢å¤æ•°æ®ï¼›</li><li>AOF é‡å†™å‘½ä»¤ BGREWRITEAOF å’Œ RBD ä½¿ç”¨çš„ BGSAVE å‘½ä»¤ä¸€æ ·éƒ½è¦åˆ›å»ºå­è¿›ç¨‹ï¼Œç´¢å¼•æ•°æ®åº“ä½“ç§¯æ¯”è¾ƒå¤§çš„æƒ…å†µä¸‹ï¼Œè¿›è¡Œ AOF æ–‡ä»¶é‡å†™å°†å ç”¨å¤§é‡èµ„æºï¼Œå¹¶å¯¼è‡´æœåŠ¡å™¨è¢«çŸ­æš‚é˜»å¡ï¼›</li></ul><h2 id="rdb-aof-æ··åˆæŒä¹…åŒ–" tabindex="-1"><a class="header-anchor" href="#rdb-aof-æ··åˆæŒä¹…åŒ–" aria-hidden="true">#</a> RDB-AOF æ··åˆæŒä¹…åŒ–</h2><p>å¼€å¯æ··åˆæŒä¹…åŒ–ï¼Œå‰ææ˜¯æ‰“å¼€ AOF æŒä¹…åŒ–åŠŸèƒ½äº†ï¼Œç„¶åå°†ä¸‹é¢çš„å€¼è®¾ç½®äº† yes</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>aof-use-rdb-preamble &lt;value&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>é‚£ä¹ˆæœåŠ¡å™¨åœ¨æ‰§è¡Œ AOF é‡å†™æ—¶ï¼Œå°±ä¼šåƒæ‰§è¡Œ BGSAVE å‘½ä»¤é‚£æ ·ï¼Œæ ¹æ®æ•°æ®åº“å½“å‰çš„çŠ¶æ€ç”Ÿæˆå‡ºç›¸åº”çš„ RDB æ•°æ®ï¼Œå¹¶ä¸”å°†è¿™äº›æ•°æ®å†™å…¥æ–°å»ºçš„ AOF æ–‡ä»¶ä¸­ï¼Œè‡³äºé‚£äº›åœ¨ AOF é‡å†™å¼€å§‹ä¹‹åæ‰§è¡Œçš„ Redis å‘½ä»¤ï¼Œåˆ™ä¼šç»§ç»­ä»¥åè®®æ–‡æœ¬çš„æ–¹å¼è¿½åŠ åˆ°æ–° AOF æ–‡ä»¶çš„æœ«å°¾ï¼Œä¹Ÿå°±æ˜¯å·²ç”±çš„ RDB æ•°æ®çš„åé¢ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>| RDB æ•°æ® | AOF æ•°æ® |
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å½“ä¸€ä¸ªæ”¯æŒ RDB-AOF æ··åˆæŒä¹…åŒ–æ¨¡å¼çš„ Redis æœåŠ¡å™¨å¯åŠ¨å¹¶è½½å…¥ AOF æ–‡ä»¶æ—¶ï¼Œå®ƒä¼šæ£€æŸ¥ AOF æ–‡ä»¶çš„å¼€å¤´æ˜¯å¦åŒ…å«äº† RDB æ ¼å¼çš„å†…å®¹ï¼›</p><ul><li>å¦‚æœåŒ…å«ï¼Œé‚£ä¹ˆæœåŠ¡å™¨ä¼šå…ˆåŠ è½½å¼€å¤´çš„ RDB æ•°æ®ï¼Œç„¶åå†åŠ è½½ä¹‹åçš„ AOF æ•°æ®ï¼›</li><li>å¦‚æœ AOF æ–‡ä»¶åªåŒ…å« AOF æ•°æ®ï¼Œé‚£ä¹ˆæœåŠ¡å™¨ä¼šç›´æ¥åŠ è½½ AOF æ•°æ®ï¼›</li></ul><h2 id="åŒæ—¶ä½¿ç”¨-rdb-æŒä¹…åŒ–å’Œ-aof-æŒä¹…åŒ–" tabindex="-1"><a class="header-anchor" href="#åŒæ—¶ä½¿ç”¨-rdb-æŒä¹…åŒ–å’Œ-aof-æŒä¹…åŒ–" aria-hidden="true">#</a> åŒæ—¶ä½¿ç”¨ RDB æŒä¹…åŒ–å’Œ AOF æŒä¹…åŒ–</h2><p>å¦‚æœæ˜¯ Redis 4.0 ä¹‹å‰çš„ç‰ˆæœ¬</p><ol><li>åŒæ—¶ä½¿ç”¨ä¸¤ç§æŒä¹…åŒ–åŠŸèƒ½ä¼šè€—è´¹å¤§é‡çš„ç³»ç»Ÿèµ„æºï¼›</li><li>Redis æœåŠ¡å™¨åœ¨å¯åŠ¨æ—¶ï¼Œä¼šä¼˜å…ˆä½¿ç”¨ AOF æ–‡ä»¶è¿›è¡Œæ•°æ®æ¢å¤ï¼Œåªæœ‰åœ¨æ²¡æœ‰æ£€æµ‹åˆ° AOF æ–‡ä»¶æ—¶ï¼Œæ‰ä¼šè€ƒè™‘å¯»æ‰¾å¹¶ä½¿ç”¨ RDB æ–‡ä»¶è¿›è¡Œæ•°æ®æ¢å¤ï¼›</li><li>å½“ Redis æœåŠ¡å™¨æ­£åœ¨åå°ç”Ÿæˆæ–°çš„ RDB æ–‡ä»¶æ—¶ï¼Œå¦‚æœæœ‰ç”¨æˆ·å‘æœåŠ¡å™¨å‘é€ BGREWRITEAOF å‘½ä»¤ï¼Œæˆ–è€…é…ç½®é€‰é¡¹ä¸­è®¾ç½®çš„ AOF é‡å†™æ¡ä»¶æ»¡è¶³äº†ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°†æŠŠ AOF é‡å†™æ“ä½œæ¨è¿Ÿåˆ° RDB æ–‡ä»¶åˆ›å»ºå®Œæ¯•ä¹‹åå†æ‰§è¡Œï¼Œä»¥æ­¤æ¥é¿å…ä¸¤ç§æŒä¹…åŒ–æ“ä½œåŒæ—¶æ‰§è¡Œå¹¶äº‰æŠ¢ç³»ç»Ÿèµ„æºï¼›</li><li>å½“æœåŠ¡å™¨æ­£åœ¨æ‰§è¡Œ BGREWRITEAOF å‘½ä»¤æ—¶ï¼Œç”¨æˆ·å‘é€æˆ–è€…è¢«è§¦å‘ BGSAVE å‘½ä»¤ä¹Ÿä¼šæ¨è¿Ÿæ‰“ç ´ BGREWRITEAOF å‘½ä»¤æ‰§è¡Œå®Œæ¯•ä¹‹åå†æ‰§è¡Œï¼›</li></ol><h2 id="shutdown-å…³é—­æœåŠ¡å™¨" tabindex="-1"><a class="header-anchor" href="#shutdown-å…³é—­æœåŠ¡å™¨" aria-hidden="true">#</a> SHUTDOWN å…³é—­æœåŠ¡å™¨</h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ Redis æœåŠ¡å™¨æ¥æ”¶åˆ° SHUTDOWN å‘½ä»¤æ—¶ï¼Œå®ƒå°†æ‰§è¡Œä¸‹é¢çš„åŠ¨ä½œï¼š</p><ol><li>åœæ­¢å¤„ç†å®¢æˆ·ç«¯å‘é€çš„å‘½ä»¤è¯·æ±‚ï¼›</li><li>æ ¹æ®æœåŠ¡å™¨çš„æŒä¹…åŒ–é…ç½®é€‰é¡¹ï¼Œå†³å®šæ˜¯å¦æ‰§è¡Œæ•°æ®ä¿å­˜æ“ä½œï¼› <ol><li>å¦‚æœæœåŠ¡å™¨å¯åŠ¨äº† RDB æŒä¹…åŒ–ï¼Œå¹¶ä¸”æ•°æ®åº“è·ç¦»æœ€åä¸€æ¬¡æˆåŠŸåˆ›å»º RDB æ–‡ä»¶ä¹‹åå‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°†æ‰§è¡Œ SAVE å‘½ä»¤ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ RDB æ–‡ä»¶ï¼›</li><li>å¦‚æœæœåŠ¡å™¨å¯ç”¨äº† AOF æŒä¹…åŒ–ï¼Œæˆ–è€…æ··åˆæŒä¹…åŒ–ï¼Œé‚£ä¹ˆå®ƒå°†åˆ·æ–° AOF æ–‡ä»¶ï¼Œç¡®ä¿æ‰€æœ‰å·²æ‰§è¡Œçš„å‘½ä»¤éƒ½è¢«è®°å½•åˆ° AOF æ–‡ä»¶ä¸­ï¼›</li><li>å¦‚æœæœåŠ¡å™¨æ²¡æœ‰å¼€å¯æŒä¹…åŒ–åŠŸèƒ½ï¼Œå°±ä¸ä¿å­˜æ•°æ®ï¼›</li></ol></li><li>æœåŠ¡å™¨è¿›ç¨‹é€€å‡ºï¼›</li></ol><p>SHUTDOWN å‘½ä»¤ä¹Ÿæ”¯æŒå‚æ•°</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>SHUTDOWN [save|nosave]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¦‚æœç»™å®šçš„æ˜¯ save å‚æ•°ï¼Œé‚£ä¹ˆæ— è®ºæœåŠ¡å™¨æ˜¯å¦å¼€å¯æŒä¹…åŒ–åŠŸèƒ½ï¼Œä¹Ÿä¼šè¿›è¡Œä¸€æ¬¡æŒä¹…åŒ–æ“ä½œã€‚</p><table><thead><tr><th>æŒä¹…åŒ–é…ç½®</th><th>SHUTDOWN save çš„è¡Œä¸º</th></tr></thead><tbody><tr><td>æœªå¼€å¯æŒä¹…åŒ–åŠŸèƒ½</td><td>SAVE å‘½ä»¤</td></tr><tr><td>åªå¼€å¯äº† RDB</td><td>SAVE å‘½ä»¤</td></tr><tr><td>åªå¼€å¯äº† AOF</td><td>åˆ·æ–° AOF æ–‡ä»¶ï¼Œç¡®ä¿æ‰€æœ‰å·²æ‰§è¡Œå‘½ä»¤éƒ½è¢«è®°å½•åˆ° AOF æ–‡ä»¶</td></tr><tr><td>å¼€å¯äº†æ··åˆæŒä¹…åŒ–</td><td>åˆ·æ–° AOF æ–‡ä»¶ï¼Œç¡®ä¿æ‰€æœ‰å·²æ‰§è¡Œå‘½ä»¤éƒ½è¢«è®°å½•åˆ° AOF æ–‡ä»¶</td></tr><tr><td>åŒæ—¶å¼€å¯äº† RDB å’Œ AOF</td><td>åˆ·æ–° AOF æ–‡ä»¶ï¼Œç¡®ä¿æ‰€æœ‰å·²æ‰§è¡Œå‘½ä»¤éƒ½è¢«è®°å½•åˆ° AOF æ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œ SAVE å‘½ä»¤</td></tr></tbody></table><h2 id="æŒä¹…åŒ–ç›¸å…³çš„é…ç½®é¡¹" tabindex="-1"><a class="header-anchor" href="#æŒä¹…åŒ–ç›¸å…³çš„é…ç½®é¡¹" aria-hidden="true">#</a> æŒä¹…åŒ–ç›¸å…³çš„é…ç½®é¡¹</h2><table><thead><tr><th>é…ç½®é¡¹</th><th>å®ä¾‹ or å¯é€‰å€¼</th><th>åŠŸèƒ½</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>save</td><td>save 900 1<br>save 300 10<br>save 60 10000</td><td>RDB</td><td>RDB æŒä¹…åŒ–é…ç½®ï¼Œä¸‰ä¸ªç­–ç•¥<br>1ã€å¦‚æœ 15 åˆ†é’Ÿå†…è‡³å°‘æœ‰ 1 ä¸ª key å‘ç”Ÿæ”¹å˜äº†å°±æŒä¹…åŒ–ä¸€æ¬¡<br>2ã€å¦‚æœ 5 åˆ†é’Ÿå†…è‡³å°‘æœ‰ 10 ä¸ª key å‘ç”Ÿæ”¹å˜äº†å°±æŒä¹…åŒ–ä¸€æ¬¡<br>3ã€å¦‚æœ 1 åˆ†é’Ÿå†…è‡³å°‘æœ‰ 10000 ä¸ª key å‘ç”Ÿæ”¹å˜äº†å°±æŒä¹…åŒ–ä¸€æ¬¡<br>å¯ä»¥é€šè¿‡æ³¨é‡Šæ‰è¿™å‡ è¡Œ saveï¼Œæ¥ç¦ç”¨æ‰ RDB åŠŸèƒ½ï¼Œæˆ–è€…ä½¿ç”¨ save &quot;&quot; æ¥ç¦ç”¨æ‰</td></tr><tr><td>stop-writes-on-bgsave-error</td><td>yes/no</td><td>RDB</td><td>æŒ‡å½“æ‰§è¡ŒBGSAVEæ—¶å‘ç”Ÿé”™è¯¯ï¼Œredisä¼šåœæ­¢å†™å…¥æ“ä½œã€‚BGSAVEæ˜¯rediså°†å†…å­˜ä¸­çš„æ•°æ®å­˜å‚¨åˆ°ç£ç›˜ä¸Šçš„ä¸€ç§æ“ä½œï¼Œå¦‚æœåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å‡ºç°äº†é”™è¯¯ï¼Œrediså°±ä¼šåœæ­¢æ¥æ”¶å†™å…¥è¯·æ±‚ï¼Œä»¥ä¿è¯æ•°æ®ä¸ä¸¢å¤±ã€‚å¦‚æœä½ å¸Œæœ›åœ¨BGSAVEæ—¶å‘ç”Ÿé”™è¯¯æ—¶ï¼Œredisä»ç„¶èƒ½ç»§ç»­æ¥æ”¶å†™å…¥è¯·æ±‚ï¼Œå¯ä»¥å°†stop-writes-on-bgsave-errorè®¾ç½®ä¸ºnoã€‚ä½†æ˜¯è¿™ç§æŒ‡æ ‡ä¸æ²»æœ¬ï¼Œæˆ‘ä»¬å¾—æ’æŸ¥ä¸ºä»€ä¹ˆBGSAVEå¤±è´¥ï¼Œå¯ä»¥å»æŸ¥çœ‹ redis æ—¥å¿—çœ‹çœ‹å…·ä½“æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´ bgsave å¤±è´¥çš„ï¼ˆé…ç½®é¡¹ logfile é…ç½®çš„æ—¥å¿—è·¯å¾„ï¼‰</td></tr><tr><td>rdbcompression</td><td>yes/no</td><td>RDB</td><td>æ‰§è¡Œ RDB å¿«ç…§æ—¶æ˜¯å¦å¼€å¯å­—ç¬¦ä¸² LZF å‹ç¼©</td></tr><tr><td>rdbchecksum</td><td>yes/no</td><td>RDB</td><td>ä»RDBçš„ç¬¬5ä¸ªç‰ˆæœ¬å¼€å§‹ï¼Œåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ äº†ä¸€ä¸ªCRC64æ ¡éªŒå’Œã€‚è¿™ä½¿å¾—æ ¼å¼æ›´åŠ æŠ—æŸåï¼Œä½†åœ¨ä¿å­˜å’ŒåŠ è½½RDBæ–‡ä»¶æ—¶ä¼šä»˜å‡ºæ€§èƒ½ä»£ä»·ï¼ˆå¤§çº¦10ï¼…ï¼‰ï¼Œå› æ­¤æ‚¨å¯ä»¥ç¦ç”¨å®ƒä»¥è·å¾—æœ€å¤§æ€§èƒ½ã€‚åœ¨ç¦ç”¨æ ¡éªŒå’Œçš„æƒ…å†µä¸‹åˆ›å»ºçš„RDBæ–‡ä»¶çš„æ ¡éªŒå’Œä¸ºé›¶ï¼Œè¿™å°†å‘Šè¯‰åŠ è½½ä»£ç è·³è¿‡æ£€æŸ¥ã€‚</td></tr><tr><td>dbfilename</td><td>dump.rdb</td><td>RDB</td><td>æŒ‡å®š RDB çš„æ–‡ä»¶å</td></tr><tr><td>dir</td><td>./</td><td>RDB å’Œ AOF</td><td>æŒ‡å®š RDB æ–‡ä»¶å’Œ AOF æ–‡ä»¶çš„å­˜æ”¾ä½ç½®ï¼Œå¿…é¡»æ˜¯ç›®å½•å</td></tr><tr><td>appendonly</td><td>yes/no</td><td>AOF</td><td>æ˜¯å¦å¼€å¯ AOF æŒä¹…åŒ–</td></tr><tr><td>appendfilename</td><td>appendonly.aof</td><td>AOF</td><td>AOF æ–‡ä»¶å</td></tr><tr><td>appendfsync</td><td>always/everysec/no</td><td>AOF</td><td>AOF æ–‡ä»¶åˆ·ç›˜é¢‘ç‡</td></tr><tr><td>no-appendfsync-on-rewrite</td><td>yes/no</td><td>AOF</td><td>AOFé‡å†™æ—¶ä¼šæ¶ˆè€—å¤§é‡ç¡¬ç›˜IOã€‚é»˜è®¤å…³é—­ã€‚ è¡¨ç¤ºåœ¨AOFé‡å†™æœŸé—´ä¸åšfsyncæ“ä½œã€‚</td></tr><tr><td>auto-aof-rewrite-percentage</td><td>100</td><td>AOF</td><td>è§¦å‘ AOF é‡å†™çš„ä½“ç§¯çš„å¢å¤§æ¯”ä¾‹</td></tr><tr><td>auto-aof-rewrite-min-size</td><td>64mb</td><td>AOF</td><td>è§¦å‘ AOF é‡å†™çš„æœ€å°ä½“ç§¯</td></tr><tr><td>aof-load-truncated</td><td>yes/no</td><td>AOF</td><td>AOFæ–‡ä»¶ä»¥è¿½åŠ æ—¥å¿—çš„æ–¹å¼ç”Ÿæˆï¼Œæ‰€ä»¥æœåŠ¡ç«¯å‘ç”Ÿæ•…éšœæ—¶å¯èƒ½ä¼šæœ‰å°¾éƒ¨å‘½ä»¤ä¸å®Œæ•´çš„æƒ…å†µã€‚å¼€å¯è¯¥å‚æ•°åï¼Œåœ¨æ­¤ç§æƒ…å†µä¸‹ï¼ŒAOFæ–‡ä»¶ä¼šæˆªæ–­å°¾éƒ¨ä¸å®Œæ•´çš„å‘½ä»¤ç„¶åç»§ç»­åŠ è½½ï¼Œå¹¶ä¸”ä¼šåœ¨æ—¥å¿—ä¸­è¿›è¡Œæç¤ºã€‚å¦‚æœä¸å¼€å¯è¯¥å‚æ•°ï¼Œåˆ™åŠ è½½AOFæ–‡ä»¶æ—¶ä¼šæ‰“å°é”™è¯¯æ—¥å¿—ï¼Œç„¶åç›´æ¥é€€å‡ºã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒAOF æ–‡ä»¶ä¸­é—´å‡ºç°é”™è¯¯æ—¶ï¼ŒæœåŠ¡å™¨è¿˜æ˜¯ä¼šæŠ¥é”™å¹¶é€€å‡ºçš„ã€‚è¿™é…ç½®é¡¹åªæ˜¯æ§åˆ¶ AOF æ–‡ä»¶æœ«å°¾çš„æŒ‡ä»¤æ˜¯å¦è¢«æˆªæ–­</td></tr><tr><td>aof-use-rdb-preamble</td><td>yes/no</td><td>AOF</td><td>æ˜¯å¦å¼€å¯æ··åˆæŒä¹…åŒ–</td></tr></tbody></table></div><!----><footer class="page-meta"><!----><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: guosgbin@163.com">Dylan Kwok</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a href="/Redis/Redis%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97.html" class="nav-link prev" aria-label="Redisæ…¢æŸ¥è¯¢æ—¥å¿—"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->Redisæ…¢æŸ¥è¯¢æ—¥å¿—</div></a><a href="/Redis/Redis%E9%94%AE%E7%A9%BA%E9%97%B4%E9%80%9A%E7%9F%A5(keyspace%20notification).html" class="nav-link next" aria-label="Redisé”®ç©ºé—´é€šçŸ¥"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">Redisé”®ç©ºé—´é€šçŸ¥<!----></div></a></nav><!----><!----><!--]--></main><!--]--><!----></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-ba4ae9cd.js" defer></script>
  </body>
</html>
